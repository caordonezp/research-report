---
title: "Informe RARE 2021"
author: "Camilo A. Ordóñez-Pinilla"
date: "12/14/2021"
output:
  html_document: default
  word_document: default
---


## Exploración de datos

```{r, echo=FALSE, warning=FALSE, message=FALSE}

library (rio)
library (ggplot2)
library (dplyr)
library (hrbrthemes)
library (psych)
library (lsr)
library (corrplot)
library (GPArotation)
library (ggmosaic)
library (sem)
library (lavaan)
library (lavaanPlot)
library (tidyr)
library (forcats)
library (waffle)
library (extrafont)
library(tidyverse)
library (devtools)
library(emojifont)
library(showtext)
library(remotes)
library(MASS)
library(gmodels)
library(formattable)
library(sjPlot)
library(sjmisc)
library(nnet)
library (ggrepel)
```

Importar los datos 

```{r}

datos <- rio::import("D:/CAMILO/OTHER ACADEMICS/INFORME RARE 2021/rare1.csv")
```

Cambiar nombres a las variables importantes (ir adicionando nombres más manejables según se necesite)

```{r}
names(datos)[2] <- 'genero'
names(datos)[1] <- 'beneficiaria_si_no'
```


Revisar las clases para ver si se necesita cambiar 

```{r}
class(datos$genero)
class(datos$beneficiaria_si_no)
```

Convertir los espacios vacíos en NO (no son beneficiarios directos)

```{r}
datos$beneficiaria_si_no[datos$beneficiaria_si_no == ""] <- "NO"
```

Chequear si quedó bien
```{r}

table(datos$beneficiaria_si_no, useNA="always")
```
Convertir esas dos variables en factores


```{r}

datos <- datos %>% mutate( genero = as.factor(genero))
datos <- datos %>% mutate( beneficiaria_si_no = as.factor(beneficiaria_si_no))

class(datos$genero)
class(datos$beneficiaria_si_no)

```


tabular
```{r}
table (datos$genero)
table (datos$beneficiaria_si_no)
```

Crear una base de datos con solo los beneficiarios (para los análisis de género)
```{r}
datos1 <- subset(datos, beneficiaria_si_no == "SI")
View(datos1)
```

OTRAS VARIABLES: Convertir en factor lo que se necesite como factor, en continua lo que se necesite como continua 

Tenencia 

```{r}

names(datos)[6] <- 'tenencia'
names(datos1)[6] <- 'tenencia'

datos <- datos %>% mutate( tenencia = as.factor(tenencia))
datos1 <- datos1 %>% mutate( tenencia = as.factor(tenencia))

class(datos$tenencia)
class(datos1$tenencia)
```
nivel educativo
```{r}

names(datos)[8] <- 'nivel_educativo'
names(datos1)[8] <- 'nivel_educativo'

datos <- datos %>% mutate( nivel_educativo = as.factor(nivel_educativo))
datos1 <- datos1 %>% mutate( nivel_educativo = as.factor(nivel_educativo))

class(datos$nivel_educativo)
class(datos1$nivel_educativo)
```


## DESCRIPTIVOS

```{r}
ggplot(data=datos1, aes(x=genero, fill=as.factor(genero))) + 
  geom_bar( ) +
  scale_fill_hue(c = 40) +
  theme(legend.position="none") + labs (y ="", x="Género") + geom_text(
     aes(label=round (after_stat(count), digits = 1), group=1),
     stat='count',
     nudge_y=0.125,
     va='bottom',
     format_string='{:.1f}%'
 ) +  scale_x_discrete(labels = c('Femenino','Masculino')) + scale_fill_brewer(palette = "Set2")
```
De los beneficiarios directos tenemos 85 personas de género femenino y 162 de género masculino.


```{r}
ggplot(data=subset(datos1), aes(x=genero, fill=genero)) + 
  geom_bar( ) +
  scale_fill_hue(c = 40) +
  theme(legend.position="none") + labs (y ="", x="Género") + geom_text(
     aes(label=round (after_stat(prop*100), digits = 1), group=1),
     stat='count',
     nudge_y=0.125,
     va='bottom',
     format_string='%' 
 ) 
```

Es decir, tenemos 65.6% de hombres y 34.4% de mujeres entre los beneficiarios directos del proyecto.

Lo mismo pero un waffle

```{r}
waffle(c('F = 34.4%' = 34.4, 'M = 65.6%' = 65.6), rows = 10, colors = c("aquamarine3", "darkorange1"),
  title = 'División de beneficiarios por género (%)', legend_pos="bottom")
```
Para tablas y pie charts

```{r}
a <- as.data.frame(table(datos1$genero, exclude = ""))
colnames (a) <- c("Género", "Frecuencia")
levels(a$'Género') <- list(Femenino="F", Masculino="M")
formattable (a,  list('Género' = color_bar(c("#00BFC4", "#F8766D"), proportion)) )
```

```{r}
a <- as.data.frame(table(datos1$genero, exclude = ""))
colnames (a) <- c("Género", "Frecuencia")
levels(a$'Género') <- list(Femenino="F", Masculino="M")
formattable (a,  list('Género' = color_tile("#00BFC4", "#F8766D")) )
```
Y el pie chart

```{r}
data <- datos1 %>% 
  group_by(genero) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(genero))
data$label <- scales::percent(data$per)

ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=genero), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label=label)) +
  guides(fill=guide_legend(title="GÉNERO")) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + ggtitle("Distribución del género de los beneficiarios") 
     
```

```{r}
data <- datos1 %>% 
  group_by(genero) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(genero))
data$label <- scales::percent(data$per)

pie <- ggplot(data, aes(genero = factor(1), fill = factor(genero)))
pie <- pie + geom_bar(width = 1, stat = "identity", aes(x="", y=per, fill=genero))
pie <- pie + coord_polar(theta = "y") 
pie <- pie + xlab("") + ylab("")
pie + scale_fill_brewer()
     
```
```{r}
data <- datos1 %>% 
  group_by(genero) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(genero))
data$label <- scales::percent(data$per)

pie1 <- ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=genero), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label=label)) +
  guides(fill=guide_legend(title="GÉNERO")) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + ggtitle("Distribución del género de los beneficiarios")

pie1 + scale_fill_brewer()
     
```
```{r}
data <- datos1 %>% 
  group_by(genero) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(genero))
data$label <- scales::percent(data$per)

pie1 <- ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=genero), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label=paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
  guides(fill=guide_legend(title="Gender"))  + ggtitle("Distribution of beneficiaries by gender")

pie1 + scale_fill_brewer(labels=c("Female", "Male"))  
```


```{r}
data <- datos1 %>% 
  group_by(genero) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(genero))
data$label <- scales::percent(data$per)

pie1 <- ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=genero), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label=paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
  guides(fill=guide_legend(title="Gender"))  + ggtitle("Distribution of beneficiaries by gender")

pie1 + scale_fill_brewer(labels=c("Female", "Male"), type = "seq", palette = "Set1")  
```



### pie chart with shades percentajes and group size

```{r}
data <- datos1 %>% 
  group_by(tenencia) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(tenencia))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=tenencia), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n))))))  + scale_fill_brewer() 
  
```
```{r}
data <- datos1 %>% 
  group_by(tenencia) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(tenencia))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=tenencia), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n))))))  + scale_fill_brewer(palette = "BuPu") 
  
```
```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(3) )

data <- datos1 %>% 
  group_by(tenencia) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(tenencia))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=tenencia), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
   
  
   
  scale_fill_manual(values = myrange)
 

  

```
```{r}
myrange <- colorRampPalette(c("blue", "red"))
plot(1:1000, col=(myrange(1000)))
```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(2) )

data <- datos1 %>% 
  group_by(genero) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(genero))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=genero), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
   guides(fill=guide_legend(title="Género"))  + ggtitle("Distribución de beneficiarios por género") +
   
  scale_fill_manual(values = myrange, labels=c("Femenino", "Masculino"))
 

  

```

```{r}



myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos1 %>% 
  group_by(mujeres_comunidad) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(mujeres_comunidad))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=mujeres_comunidad), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
   guides(fill=guide_legend(title=""))  + ggtitle("¿En qué medida las mujeres de la comunidad \n participan en las decisiones de la producción agrícola?") +
   
  scale_fill_manual(values = myrange, labels=c("Más o menos", "Muchísimo", "Mucho", "Nada", "Poco"))
 
```

```{r}

datos1 %>%
  count(genero, mujeres_comunidad) %>%       
  group_by(mujeres_comunidad) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = mujeres_comunidad, y= proporciones, fill = genero, xlab="Municipios") +
   geom_bar(stat="identity", width=.5, position = "dodge") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%"))) + geom_text(aes(label=n), nudge_y = -5) + scale_x_discrete(labels = c("Más o menos", "Muchísimo", "Mucho", "Nada", "Poco")) +   guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + ggtitle ("Respuestas a la pregunta sobre el nivel \n de envolvimiento de las mujeres de la comunidad en las \n decisiones de producción agrícola, divididas por género") + xlab ("") + ylab ("")
```

```{r}



myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos1 %>% 
  group_by(mujeres_familia) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(mujeres_familia))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=mujeres_familia), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
   guides(fill=guide_legend(title=""))  + ggtitle("¿En qué medida las mujeres de la familia \n participan en las decisiones de la producción agrícola?") +
   
  scale_fill_manual(values = myrange, labels=c("Más o menos", "Muchísimo", "Mucho", "Nada", "Poco"))
 
```

```{r}



myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos1 %>% 
  group_by(MUNICIPIO) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(MUNICIPIO))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=MUNICIPIO), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("Cubarral", "El Castillo", "El Dorado", "Granada", "Lejanías"))
 
```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(3) )

data <- datos1 %>% 
  group_by(tenencia) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(tenencia))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=tenencia), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="Tenencia")) +
  geom_text(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)
 
```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(6) )

data <- datos1 %>% 
  group_by(nivel_educativo) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(nivel_educativo))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=nivel_educativo), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="Nivel educativo")) +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)
 
```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(6) )

data <- datos1 %>% 
  filter(!is.na(hijos)) %>%
  group_by(hijos) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(hijos))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=hijos), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="Número de hijos")) +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)
 
```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(3) )

data <- datos1 %>% 
  filter(!is.na(tipo_de_cultivo)) %>%
  group_by(tipo_de_cultivo) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(tipo_de_cultivo))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=tipo_de_cultivo), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="Tipo de cultivo")) +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)
 
```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(tipo_asistencia_técnica)) %>%
  group_by(tipo_asistencia_técnica) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(tipo_asistencia_técnica))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=tipo_asistencia_técnica), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="Tipo de asistencia técnica")) +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)
 
```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(3) )

data <- datos %>% 
  filter(!is.na(asistencia_tecnica)) %>%
  filter(asistencia_tecnica == "No recibo asistencia tÃ©cnica" | asistencia_tecnica == "AlcaldÃ­a, Otra" | asistencia_tecnica == "Otra") %>%
  group_by(asistencia_tecnica) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(asistencia_tecnica))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=asistencia_tecnica), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="Recibe asistencia técnica")) +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("Alcaldía, Otra", "No recibo asistencia técnica", "Otra"))
 
```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(fertilizar_analizar_mejor_yo)) %>%
  
  group_by(fertilizar_analizar_mejor_yo) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(fertilizar_analizar_mejor_yo))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=fertilizar_analizar_mejor_yo), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="Fertilizar basado en análisis es lo mejor para mi bolsilo y el de mi familia")) +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)
 
```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(4) )

data <- datos %>% 
  filter(!is.na(cuanto_analisis_suelo)) %>%
  group_by(cuanto_analisis_suelo) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(cuanto_analisis_suelo))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=cuanto_analisis_suelo), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="¿Hace cuánto realizó el último análisis de suelo?")) +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)
 
```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(valioso_analisis_suelo)) %>%
  group_by(valioso_analisis_suelo) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(valioso_analisis_suelo))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=valioso_analisis_suelo), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("¿Vale la pena hacer el análisis de suelo al menos cada 3 años?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)
 
```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(3) )

data <- datos %>% 
  filter(!is.na(leer_suelos)) %>%
  group_by(leer_suelos) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(leer_suelos))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=leer_suelos), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Sabe leer el análisis de suelos") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)
 
```


```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(fertilizar_analizar_mejor_comunidad)) %>%
  group_by(fertilizar_analizar_mejor_comunidad) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(fertilizar_analizar_mejor_comunidad))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=fertilizar_analizar_mejor_comunidad), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Fertilizar basado en resultados de un análisis de suelo es lo mejor para mi comunidad") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)
 
```


```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(fertilizar_analizar_mejor_ambiente)) %>%
  group_by(fertilizar_analizar_mejor_ambiente) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(fertilizar_analizar_mejor_ambiente))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=fertilizar_analizar_mejor_ambiente), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Fertilizar basado en resultados de un análisis de suelo es lo mejor para el ambiente") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)
 
```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(cuantos_fertilizan_analisis)) %>%
  group_by(cuantos_fertilizan_analisis) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(cuantos_fertilizan_analisis))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=cuantos_fertilizan_analisis), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Según su opinión, ¿cuántos productores de \n la comunidad fertilizan con base en \n los resultados de un análisis de suelo?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)
 
```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(cuantos_deberían_analisis)) %>%
  group_by(cuantos_deberían_analisis) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(cuantos_deberían_analisis))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=cuantos_deberían_analisis), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Según su opinión, ¿cuántos productores de \n la comunidad deberían fertilizar con base en \n los resultados de un análisis de suelo?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)
 
```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(2) )

data <- datos %>% 
  filter(!is.na(usa_compost)) %>%
  group_by(usa_compost) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(usa_compost))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=usa_compost), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Ha aplicado alguna vez compost a sus suelos?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("No", "Sí"))
 
```

```{r}

names(datos)[44] <- 'organica_mejor_yo_familia'
names(datos1)[44] <- 'organica_mejor_yo_familia'

datos <- datos %>% mutate( organica_mejor_yo = as.factor(organica_mejor_yo_familia))
datos1 <- datos1 %>% mutate( organica_mejor_yo = as.factor(organica_mejor_yo_familia))

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(organica_mejor_yo_familia)) %>%
  group_by(organica_mejor_yo_familia) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(organica_mejor_yo_familia))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=organica_mejor_yo_familia), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Aplicar coberturas vegetales a mi suelo \n es lo mejor para mí y mi familia") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)

```

```{r}

names(datos)[45] <- 'organica_mejor_comunidad'
names(datos1)[45] <- 'organica_mejor_comunidad'

datos <- datos %>% mutate( organica_mejor_comunidad = as.factor(organica_mejor_comunidad))
datos1 <- datos1 %>% mutate( organica_mejor_comunidad = as.factor(organica_mejor_comunidad))

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(organica_mejor_comunidad)) %>%
  group_by(organica_mejor_comunidad) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(organica_mejor_comunidad))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=organica_mejor_comunidad), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Aplicar coberturas vegetales a mi suelo \n es lo mejor para mi comunidad") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)

```
```{r}

names(datos)[43] <- 'organica_mejor_ambiente'
names(datos1)[43] <- 'organica_mejor_ambiente'

datos <- datos %>% mutate( organica_mejor_ambiente = as.factor(organica_mejor_ambiente))
datos1 <- datos1 %>% mutate( organica_mejor_ambiente = as.factor(organica_mejor_ambiente))

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(organica_mejor_ambiente)) %>%
  group_by(organica_mejor_ambiente) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(organica_mejor_ambiente))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=organica_mejor_ambiente), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Aplicar coberturas vegetales a mi suelo \n es lo mejor para mi ambiente") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)

```

```{r}


myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(compost_empirica)) %>%
  group_by(compost_empirica) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(compost_empirica))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=compost_empirica), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Según su opinión, ¿cuántos productores de la \n comunidad aplican materia orgánica a sus suelos?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)

```


```{r}


myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(compost_normativa)) %>%
  group_by(compost_normativa) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(compost_normativa))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=compost_normativa), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Según su opinión, ¿cuántos productores de la \n comunidad deberían aplicar materia orgánica a sus suelos?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("La mitad", "Más de la mitad", "Menos de la mitad", "Ninguno", "Todos"))

```


```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(2) )

data <- datos %>% 
  filter(!is.na(agroclimaticos)) %>%
  filter(agroclimaticos == "No" | agroclimaticos == "SÃ­") %>%
  group_by(agroclimaticos) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(agroclimaticos))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=agroclimaticos), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Utiliza los datos de lluvia y temperatura \n para ajustar el riego de su cultivo durante el mes?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("No", "Sí"))

```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(agroclimaticos_yo)) %>%
  
  group_by(agroclimaticos_yo) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(agroclimaticos_yo))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=agroclimaticos_yo), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Recolectar y usar datos de lluvia y temperatura para ajustar \n el riego de mi cultivo es lo mejor para mi bolsillo y el de mi familia") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)

```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(agroclimaticos_comunidad)) %>%
  
  group_by(agroclimaticos_comunidad) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(agroclimaticos_comunidad))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=agroclimaticos_comunidad), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Recolectar y usar datos de lluvia y temperatura para ajustar \n el riego de mi cultivo es lo mejor para mi comunidad") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)

```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(agroclimaticos_ambiente)) %>%
  
  group_by(agroclimaticos_ambiente) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(agroclimaticos_ambiente))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=agroclimaticos_ambiente), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Recolectar y usar datos de lluvia y temperatura para ajustar \n el riego de mi cultivo es lo mejor para el ambiente") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)

```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(agroclimaticos_descriptiva)) %>%
  filter (agroclimaticos_descriptiva == "La mitad" | agroclimaticos_descriptiva == "MÃ¡s de la mitad" | agroclimaticos_descriptiva == "Menos de la mitad" | agroclimaticos_descriptiva == "Ninguno" | agroclimaticos_descriptiva == "Todos") %>%
  
  group_by(agroclimaticos_descriptiva) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(agroclimaticos_descriptiva))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=agroclimaticos_descriptiva), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Según su opinión, ¿cuántos productores de la comunidad recolectan y usan \n datos de lluvia y temperatura para ajustar el riego de su cultivo?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels = c("La mitad", "Más de la mitad", "Menos de la mitad", "Ninguno", "Todos"))

```

```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(agroclimaticos_normativa)) %>%
  
  
  group_by(agroclimaticos_normativa) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(agroclimaticos_normativa))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=agroclimaticos_normativa), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Según su opinión, ¿cuántos productores de la comunidad deberían recolectar y usar \n datos de lluvia y temperatura para ajustar el riego de su cultivo?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels = c("La mitad", "Más de la mitad", "Menos de la mitad", "Ninguno", "Todos"))

```

```{r}

names(datos)[67] <- 'cercas_vivas'
names(datos1)[67] <- 'cercas_vivas'

datos <- datos %>% mutate( cercas_vivas = as.factor(cercas_vivas))
datos1 <- datos1 %>% mutate( cercas_vivas = as.factor(cercas_vivas))

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(3) )

data <- datos %>% 
  filter(!is.na(cercas_vivas)) %>%
  
  filter(cercas_vivas == "No" | cercas_vivas == "Tengo algunas dudas" | cercas_vivas == "SÃ­") %>%
  
  group_by(cercas_vivas) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(cercas_vivas))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=cercas_vivas), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("¿Sabe implementar cercas vivas?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("No", "Sí", "Tengo algunas dudas"))

```

```{r}

names(datos)[69] <- 'cercas_vivas_yo'
names(datos1)[69] <- 'cercas_vivas_yo'

datos <- datos %>% mutate( cercas_vivas_yo = as.factor(cercas_vivas_yo))
datos1 <- datos1 %>% mutate( cercas_vivas_yo = as.factor(cercas_vivas_yo))

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(4) )

data <- datos %>% 
  filter(!is.na(cercas_vivas_yo)) %>%
  
  group_by(cercas_vivas_yo) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(cercas_vivas_yo))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=cercas_vivas_yo), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Implementar cercas vivas en mi finca es lo mejor \n para mi bolsillo y el de mi familia") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)

```

```{r}

names(datos)[70] <- 'cercas_vivas_comunidad'
names(datos1)[70] <- 'cercas_vivas_comunidad'

datos <- datos %>% mutate( cercas_vivas_comunidad = as.factor(cercas_vivas_comunidad))
datos1 <- datos1 %>% mutate( cercas_vivas_comunidad = as.factor(cercas_vivas_comunidad))

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(4) )

data <- datos %>% 
  filter(!is.na(cercas_vivas_comunidad)) %>%
  
  group_by(cercas_vivas_comunidad) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(cercas_vivas_comunidad))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=cercas_vivas_comunidad), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Implementar cercas vivas en mi finca es lo mejor \n para mi comunidad") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)

```


```{r}

names(datos)[68] <- 'cercas_vivas_ambiente'
names(datos1)[68] <- 'cercas_vivas_ambiente'

datos <- datos %>% mutate( cercas_vivas_ambiente = as.factor(cercas_vivas_ambiente))
datos1 <- datos1 %>% mutate( cercas_vivas_ambiente = as.factor(cercas_vivas_ambiente))

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(4) )

data <- datos %>% 
  filter(!is.na(cercas_vivas_ambiente)) %>%
  
  group_by(cercas_vivas_ambiente) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(cercas_vivas_ambiente))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=cercas_vivas_ambiente), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Implementar cercas vivas en mi finca es lo mejor \n para el ambiente") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)

```

```{r}


myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(cercasvivas_normativa)) %>%
  
  group_by(cercasvivas_normativa) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(cercasvivas_normativa))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=cercasvivas_normativa), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Según su opinión, ¿cuántos productores de la comunidad \n deberían tener cercas vivas?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("La mitad", "Más de la mitad", "Menos de la mitad", "Ninguno", "Todos"))

```

```{r}


myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(2) )

data <- datos %>% 
  filter(!is.na(quemas)) %>%
  
  group_by(quemas) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(quemas))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=quemas), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("¿Realiza quemas de pastizales, rastrojos y residuos de cosecha?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("No", "Sí"))

```

```{r}


myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(quemas_descriptivo)) %>%
  
  group_by(quemas_descriptivo) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(quemas_descriptivo))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=quemas_descriptivo), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Según su opinión, ¿cuántos productores de la comunidad realizan \n quemas de pastizales, rastrojos o residuos de cosecha?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("La mitad", "Más de la mitad", "Menos de la mitad", "Ninguno", "Todos"))

```

```{r}


myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(quemas_normativo)) %>%
  
  group_by(quemas_normativo) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(quemas_normativo))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=quemas_normativo), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Según su opinión, ¿cuántos productores de la comunidad deberían realizar \n quemas de pastizales, rastrojos o residuos de cosecha?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("La mitad", "Más de la mitad", "Menos de la mitad", "Ninguno", "Todos"))

```

```{r}


myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(2) )

data <- datos %>% 
  filter(!is.na(especiesnativas)) %>%
  
  group_by(especiesnativas) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(especiesnativas))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=especiesnativas), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("¿Planta especies nativas en las rondas y \n nacimientos de fuentes de agua?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("No", "Sí"))

```

```{r}

names(datos)[80] <- 'especiesnativas_yo'
names(datos1)[80] <- 'especiesnativas_yo'

datos <- datos %>% mutate( especiesnativas_yo = as.factor(especiesnativas_yo))
datos1 <- datos1 %>% mutate( especiesnativas_yo = as.factor(especiesnativas_yo))

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(4) )

data <- datos %>% 
  filter(!is.na(especiesnativas_yo)) %>%
  
  group_by(especiesnativas_yo) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(especiesnativas_yo))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=especiesnativas_yo), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Plantar especies nativas en las rondas y nacimientos de fuentes de agua es lo mejor para mi bolsillo y el de mi familia") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)

```

```{r}

names(datos)[81] <- 'especiesnativas_comunidad'
names(datos1)[81] <- 'especiesnativas_comunidad'

datos <- datos %>% mutate( especiesnativas_comunidad = as.factor(especiesnativas_comunidad))
datos1 <- datos1 %>% mutate( especiesnativas_comunidad = as.factor(especiesnativas_comunidad))

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(4) )

data <- datos %>% 
  filter(!is.na(especiesnativas_comunidad)) %>%
  
  group_by(especiesnativas_comunidad) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(especiesnativas_comunidad))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=especiesnativas_comunidad), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Plantar especies nativas en las rondas y nacimientos de fuentes de agua es lo mejor para mi comunidad") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)

```

```{r}


myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(especiesnativas_empirica)) %>%
  
  group_by(especiesnativas_empirica) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(especiesnativas_empirica))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=especiesnativas_empirica), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Según su opinión, ¿cuántos productores de la comunidad plantan especies \n nativas en las rondas y nacimientos de fuentes de agua normalmente?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("La mitad", "Más de la mitad", "Menos de la mitad", "Ninguno", "Todos"))

```

```{r}


myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(especiesnativas_normativa)) %>%
  
  group_by(especiesnativas_normativa) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(especiesnativas_normativa))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=especiesnativas_normativa), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Según su opinión, ¿cuántos productores de la comunidad deberían plantar especies \n nativas en las rondas y nacimientos de fuentes de agua normalmente?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("La mitad", "Más de la mitad", "Menos de la mitad", "Ninguno", "Todos"))

```

```{r}



myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(registros_empirica)) %>%
  
  group_by(registros_empirica) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(registros_empirica))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=registros_empirica), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Según su opinión, ¿cuántos productores de la comunidad llevan \n registro escrito de los costos de producción?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("La mitad", "Más de la mitad", "Menos de la mitad", "Ninguno", "Todos"))

```
```{r}



myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(registros_normativa)) %>%
  filter (registros_normativa == "La mitad" | registros_normativa == "MÃ¡s de la mitad" | registros_normativa == "Menos de la mitad" | registros_normativa == "Ninguno" | registros_normativa == "Todos") %>%
  
  group_by(registros_normativa) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(registros_normativa))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=registros_normativa), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("Según su opinión, ¿cuántos productores de la comunidad deberían llevar \n registro escrito de los costos de producción?") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange, labels=c("La mitad", "Más de la mitad", "Menos de la mitad", "Ninguno", "Todos"))

```

```{r}



myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(5) )

data <- datos %>% 
  filter(!is.na(cambioclimatico)) %>%
  
  
  group_by(cambioclimatico) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(cambioclimatico))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=cambioclimatico), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("El comportamiento de la lluvia y la temperatura ha cambiado \n bastante a como era hace algunos años") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)

```


```{r}

myrange <- colorRampPalette(c("blue", "red"))
myrange <- as.list( myrange(6) )

data <- datos %>% 
  filter(!is.na(cambioclimatico_afecta)) %>%
  
  
  group_by(cambioclimatico_afecta) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(cambioclimatico_afecta))
data$label <- scales::percent(data$per)

 ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=cambioclimatico_afecta), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+ guides(fill=guide_legend(title="")) + ggtitle ("El cambio climático puede afectar mi producción") +
  geom_text_repel(aes(x=1, y = cumsum(per) - per/2, label= paste0(label, sep="\n", (paste0("n=", sprintf("%d",n)))))) +
   
    scale_fill_manual(values = myrange)

```



```{r}
data <- datos %>% 
  group_by(beneficiaria_si_no) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(beneficiaria_si_no))
data$label <- scales::percent(data$per)

ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=beneficiaria_si_no), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label=label)) +
  guides(fill=guide_legend(title="Beneficiario")) + ggtitle("Distribución comparando si son o no beneficiarios")
     
```

```{r}
e <- as.data.frame(table(datos$beneficiaria_si_no, exclude = ""))
colnames (e) <- c("Beneficiario", "Frecuencia")

formattable (e,  list('Beneficiario' = color_bar(c("#00BFC4", "#F8766D"))) )
```
```{r}

datos1 %>%
  count(genero, MUNICIPIO) %>%       
  group_by(MUNICIPIO) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = MUNICIPIO, y= proporciones, fill = genero, xlab="Municipios") +
   geom_bar(stat="identity", width=.5, position = "dodge") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%"))) + scale_x_discrete(labels = c('Cubarral','El Castillo', "El Dorado", "Granada", "Lejanías")) +   guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + ggtitle ("Distribución de género por municipio") + xlab ("Municipios") + ylab ("Proporciones")
```

IDEA, HACERLO PERO NO CON PROPORCIONES, SINO CON LA FRECUENCIA, A ESE SÍ SE LE PUEDE CALCULAR MEDIA , DESVIACIÓN STANDARD

```{r}

datos1 %>%
  count(genero, MUNICIPIO) %>%       
  group_by(MUNICIPIO) %>%
  mutate(values= n) %>%

 ggplot() + 
    aes(MUNICIPIO, values, fill=genero) +
    geom_bar(stat="identity", position="dodge") +
    geom_text(aes(label=n)) + 
    scale_x_discrete(labels = c('Cubarral','El Castillo', "El Dorado", "Granada", "Lejanías")) +            guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + 
  ggtitle ("Frecuencias de género por municipio") + xlab ("Municipios") + ylab ("Valores")

```

#### barplot with percentajes and group size

```{r}

datos1 %>%
  count(genero, MUNICIPIO) %>%       
  group_by(MUNICIPIO) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = MUNICIPIO, y= proporciones, fill = genero, xlab="Municipios") +
   geom_bar(stat="identity", width=.5, position = "dodge") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%"))) + geom_text(aes(label=n), nudge_y = -5) + scale_x_discrete(labels = c('Cubarral','El Castillo', "El Dorado", "Granada", "Lejanías")) +   guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + ggtitle ("Distribución de género por municipio") + xlab ("Municipios") + ylab ("Proporciones")
```



```{r}

datos1 %>%
  group_by(MUNICIPIO, genero) %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n)
  
test <- ggplot (datos1, aes(x = MUNICIPIO, y= prop, fill = genero, xlab="Municipios")) +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(.9)) +
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%"))) + geom_text(aes(label=n), nudge_y = -5) +
  
   scale_x_discrete(labels = c('Cubarral','El Castillo', "El Dorado", "Granada", "Lejanías")) + 
  
    guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + 
  
  ggtitle ("Distribución de género por municipio") +
  
  xlab ("Municipios") +
  
  ylab ("Proporciones")


 test

```



```{r}

datos1 %>%
  group_by(MUNICIPIO, genero) %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
ggplot () + aes(x = MUNICIPIO, y= prop, fill = genero, xlab="Municipios") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(.9)) +
  
   geom_text(aes(label=paste0(sprintf("%1.1f", prop),"%"))) + geom_text(aes(label=n), nudge_y = -5) +
  
   scale_x_discrete(labels = c('Cubarral','El Castillo', "El Dorado", "Granada", "Lejanías")) + 
  
    guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + 
  
  ggtitle ("Distribución de género por municipio") +
  
  xlab ("Municipios") +
  
  ylab ("Proporciones")


 

```


```{r}

datos1 %>%
  group_by(MUNICIPIO, genero) %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
ggplot () + aes(x = MUNICIPIO, y= prop, fill = genero, xlab="Municipios") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5)) +
  
   
  
   scale_x_discrete(labels = c('Cubarral','El Castillo', "El Dorado", "Granada", "Lejanías")) + 
  
    guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + 
  
  ggtitle ("Distribución de género por municipio") +
  
  xlab ("Municipios") +
  
  ylab ("Proporciones")

```


```{r}

datos1 %>%
  group_by(MUNICIPIO, genero) %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = MUNICIPIO, y= prop, fill = genero, xlab="Municipios") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5)) +
  
      scale_x_discrete(labels = c('Cubarral','El Castillo', "El Dorado", "Granada", "Lejanías")) + 
  
    guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + 
  
  ggtitle ("Distribución de género por municipio") +
  
  xlab ("Municipios") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.1) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.07)




```

```{r}

datos1 %>%
  group_by(tenencia, genero) %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = tenencia, y= prop, fill = genero, xlab="Municipios") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5)) +
  
      scale_x_discrete(labels = c('Arrendador','Cosechero', "Propietario")) + 
  
    guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + 
  
  ggtitle ("Distribución de género por tenencia") +
  
  xlab ("Tenencia") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.1) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = 0.02)

```

```{r}

datos %>% 
  filter(tenencia == "Arrendador" | tenencia == "Cosechero" | tenencia == "Propietario") %>%
  group_by(tenencia, beneficiaria_si_no) %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = tenencia, y= prop, fill = beneficiaria_si_no) +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5)) +
  
      
  
    guides(fill=guide_legend(title="Beneficiaria sí/no")) +  
  
  ggtitle ("Distribución de condición por tenencia") +
  
  xlab ("Tenencia") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.1) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y =  -0.06)

```


```{r}

datos1 %>% 
  
  group_by(nivel_educativo, genero) %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = nivel_educativo, y= prop, fill = genero) +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5)) +
  
      
  
    guides(fill=guide_legend(title="Género")) +  
  
  ggtitle ("Nivel educativo por género") +
  
  xlab ("Nivel educativo") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y =  -0.2) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y =  -0.25)

```

```{r}

datos1 %>% 
  
  group_by(nivel_educativo, genero) %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = nivel_educativo, y= prop, fill = genero) +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5)) +
  
      
  
    guides(fill=guide_legend(title="Género")) +  
  
  ggtitle ("Nivel educativo por género") +
  
  xlab ("Nivel educativo") +
  
  ylab ("") 

```

```{r}

datos1 %>% 
  
  group_by(nivel_educativo, genero) %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = nivel_educativo, y= prop, fill = genero) +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5)) +
  
      
  
    guides(fill=guide_legend(title="Género")) +  
  
  ggtitle ("Nivel educativo por género") +
  
  xlab ("Nivel educativo") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y =  -0.1)

```

```{r}

datos1 %>%
  group_by(hijos, genero) %>%
  filter(!is.na(hijos))%>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = hijos, y= prop, fill = genero, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + 
  
  ggtitle ("Distribución de número de hijos por género") +
  
  xlab ("Número de hijos") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.1) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.04)
```


```{r}

datos1 %>%
  group_by(tipo_de_cultivo, genero) %>%
  filter(!is.na(tipo_de_cultivo))%>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = tipo_de_cultivo, y= prop, fill = genero, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + 
  
  ggtitle ("Distribución del tipo de cultivo por género") +
  
  xlab ("Tipo de cultivo") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.1) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.04)
```


```{r}

datos %>%
  group_by(tipo_de_cultivo, beneficiaria_si_no) %>%
  filter(tipo_de_cultivo == "Ambos" | tipo_de_cultivo == "Permanente" | tipo_de_cultivo == "Transitorio")%>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = tipo_de_cultivo, y= prop, fill = beneficiaria_si_no, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Beneficiaria Sí/No"))  + 
  
  ggtitle ("Distribución del tipo de cultivo por condición") +
  
  xlab ("Tipo de cultivo") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.1) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.04)
```

```{r}
chisq.test(datos$beneficiaria_si_no, datos$tipo_de_cultivo)
```
There are association

```{r}

model88 <- multinom(tipo_de_cultivo ~ beneficiaria_si_no, data=datos)
summary (model88)

odds88 <- exp(coef(model88))
odds88

zvalues88 <- summary(model88)$coefficients / summary(model88)$standard.errors
p.values88 <- pnorm(abs(zvalues88), lower.tail=FALSE)*2
p.values88

```

```{r}

datos1 %>%
  group_by(cuanto_analisis_suelo, genero)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = cuanto_analisis_suelo, y= prop, fill = genero, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Género"))  + 
  
  ggtitle ("Análisis de suelo y género") +
  
  xlab ("Tiempo") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.1) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.04) + theme(axis.text.x = element_text(angle =35, hjust = 1))
```


```{r}

datos1 %>%
  filter(!is.na(leer_suelos))%>%
  group_by(leer_suelos, genero)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = leer_suelos, y= prop, fill = genero, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Género"))  + 
  
  ggtitle ("Fertilización basada en análisis de suelo por género") +
  
  xlab ("") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.1) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.04)  
  
  
```



```{r}

datos %>%
  filter(!is.na(fertilizar_analizar_mejor_comunidad))%>%
  group_by(fertilizar_analizar_mejor_comunidad, beneficiaria_si_no)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = fertilizar_analizar_mejor_comunidad, y= prop, fill = beneficiaria_si_no, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Beneficiario Sí/No"))  + 
  
  ggtitle ("Fertilización basada en análisis de suelo es \n lo mejor para la comunidad por condición") +
  
  xlab ("") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.1) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.04)   +
   theme(axis.text.x = element_text(angle =35, hjust = 1))
  
  
```

```{r}

datos %>%
  filter(!is.na(cuantos_fertilizan_analisis))%>%
  group_by(cuantos_fertilizan_analisis, beneficiaria_si_no)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = cuantos_fertilizan_analisis, y= prop, fill = beneficiaria_si_no, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Beneficiario Sí/No"))  + 
  
  ggtitle ("¿Cuántos productores usan el análisis de suelos para la fertilización, por condición?") +
  
  xlab ("") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.15) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.08)   +
   theme(axis.text.x = element_text(angle =35, hjust = 1))
  
  
```

```{r}

datos %>%
  filter(!is.na(cuantos_fertilizan_analisis))%>%
  group_by(cuantos_fertilizan_analisis, beneficiaria_si_no)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = cuantos_fertilizan_analisis, y= prop, fill = beneficiaria_si_no, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Beneficiario Sí/No"))  + 
  
  ggtitle ("¿Cuántos productores usan el análisis de suelos para la fertilización, por condición?") +
  
  xlab ("") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.08)   +
   theme(axis.text.x = element_text(angle =35, hjust = 1))
  
  
```

```{r}

datos %>%
  filter(!is.na(cuantos_fertilizan_analisis))%>%
  group_by(cuantos_fertilizan_analisis, beneficiaria_si_no)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = cuantos_fertilizan_analisis, y= prop, fill = beneficiaria_si_no, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Beneficiario Sí/No"))  + 
  
  ggtitle ("¿Cuántos productores usan el análisis de suelos para la fertilización, por condición?") +
  
  xlab ("") +
  
  ylab ("") +
  
  
  
   theme(axis.text.x = element_text(angle =35, hjust = 1))
  
  
```

```{r}

datos1 %>%
  filter(!is.na(usa_compost))%>%
  group_by(usa_compost, genero)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = usa_compost, y= prop, fill = genero, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Género"))  + 
  
  ggtitle ("Uso de compost por género") +
  
  xlab ("") +
  
  ylab ("") + scale_x_discrete(labels = c("No", "Sí")) +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.11) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.08)   +
   theme(axis.text.x = element_text(angle =35, hjust = 1))
  
  
```


```{r}

model89 <- multinom(leer_suelos ~ genero, data=datos1)
summary (model89)

odds89 <- exp(coef(model89))
odds89

zvalues89 <- summary(model89)$coefficients / summary(model89)$standard.errors
p.values89 <- pnorm(abs(zvalues89), lower.tail=FALSE)*2
p.values89

```

```{r}

model90 <- multinom(cuantos_fertilizan_analisis ~ beneficiaria_si_no, data=datos)
summary (model90)

odds90 <- exp(coef(model90))
odds90

zvalues90 <- summary(model90)$coefficients / summary(model90)$standard.errors
p.values90 <- pnorm(abs(zvalues90), lower.tail=FALSE)*2
p.values90

```


```{r}

datos1 %>%
  count(genero, MUNICIPIO) %>%       
  group_by(MUNICIPIO) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = MUNICIPIO, y= proporciones, fill = genero, xlab="Municipios") +
   geom_bar(stat="identity", width=.5, position = "dodge") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%"))) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -5) + scale_x_discrete(labels = c('Cubarral','El Castillo', "El Dorado", "Granada", "Lejanías")) +   guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + ggtitle ("Distribución de género por municipio") + xlab ("Municipios") + ylab ("Proporciones")
```

```{r}

datos %>%
  group_by(cuanto_analisis_suelo, beneficiaria_si_no)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = cuanto_analisis_suelo, y= prop, fill = beneficiaria_si_no, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Beneficiario Sí/No"))  + 
  
  ggtitle ("Análisis de suelo y condición") +
  
  xlab ("Tiempo") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.1) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.04) 
```

```{r}

datos %>%
  filter(!is.na(leer_suelos))%>%
  group_by(valioso_analisis_suelo, beneficiaria_si_no)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = valioso_analisis_suelo, y= prop, fill = beneficiaria_si_no, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Beneficiario Sí/No"))  + 
  
  ggtitle ("Es valioso hacer el análisis de suelo y condición") +
  
  xlab ("Tiempo") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.1) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.01) + theme(axis.text.x = element_text(angle =35, hjust = 1))
```


```{r}

datos %>%
  filter(!is.na(leer_suelos))%>%
  group_by(leer_suelos, beneficiaria_si_no)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = leer_suelos, y= prop, fill = beneficiaria_si_no, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Beneficiaria Sí/No"))  + 
  
  ggtitle ("Fertilización basada en análisis de suelo por condición") +
  
  xlab ("") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.1) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.04)  
  
  
```

```{r modelo logistico saber leer suelos por condicion}

model90<- multinom(leer_suelos ~ beneficiaria_si_no, data=datos)
summary (model90)

odds90 <- exp(coef(model90))
odds90

zvalues90 <- summary(model90)$coefficients / summary(model90)$standard.errors
p.values90 <- pnorm(abs(zvalues90), lower.tail=FALSE)*2
p.values90

```

```{r}

datos1 %>%
  filter(!is.na(fertilizar_analizar_mejor_yo))%>%
  group_by(fertilizar_analizar_mejor_yo, genero)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = fertilizar_analizar_mejor_yo, y= prop, fill = genero, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Género"))  + 
  
  ggtitle ("Fertilización basada en análisis de suelo es lo mejor para mí y familia por genero") +
  
  xlab ("") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.1) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.04)  + theme(axis.text.x = element_text(angle =35, hjust = 1))
  
  
```



```{r}

datos1 %>%
  filter(!is.na(fertilizar_analizar_mejor_yo))%>%
  group_by(fertilizar_analizar_mejor_yo, genero)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = fertilizar_analizar_mejor_yo, y= prop, fill = genero, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Género"))  + 
  
  ggtitle ("Fertilización basada en análisis de suelo es lo mejor para mí y familia por genero") +
  
  xlab ("") +
  
  ylab ("") +
  
  
    geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.04)  + theme(axis.text.x = element_text(angle =35, hjust = 1))
  
  
```

```{r}

datos %>%
  filter(!is.na(fertilizar_analizar_mejor_yo))%>%
  group_by(fertilizar_analizar_mejor_yo, beneficiaria_si_no)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = fertilizar_analizar_mejor_yo, y= prop, fill = beneficiaria_si_no, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Beneficiaria Sí/No"))  + 
  
  ggtitle ("Fertilización basada en análisis de suelo es lo mejor para mí y familia por condicion") +
  
  xlab ("") +
  
  ylab ("") +
  
  
   geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), nudge_y = -0.1) + geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.04)  + theme(axis.text.x = element_text(angle =35, hjust = 1))
  
  
```


```{r}

datos %>%
  filter(!is.na(agroclimaticos_yo))%>%
  group_by(agroclimaticos_yo, beneficiaria_si_no)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = agroclimaticos_yo, y= prop, fill = beneficiaria_si_no, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Beneficiaria Sí/No"))  + 
  
  ggtitle ("Recolectar y usar datos de lluvia y temperatura para ajustar el riego \n de mi cultivo es lo mejor para mi bolsillo y el de mi familia, por condicion") +
  
  xlab ("") +
  
  ylab ("") +
  
  
    geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.3)  + theme(axis.text.x = element_text(angle =35, hjust = 1))
  
  
```

```{r}

datos %>%
  filter(!is.na(agroclimaticos_comunidad))%>%
  group_by(agroclimaticos_comunidad, beneficiaria_si_no)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = agroclimaticos_comunidad, y= prop, fill = beneficiaria_si_no, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Beneficiaria Sí/No"))  + 
  
  ggtitle ("Recolectar y usar datos de lluvia y temperatura para ajustar el riego \n de mi cultivo es lo mejor para mi comunidad, por condicion") +
  
  xlab ("") +
  
  ylab ("") +
  
  
    geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.3)  + theme(axis.text.x = element_text(angle =35, hjust = 1))
  
  
```

```{r}

datos %>%
  filter(!is.na(agroclimaticos_ambiente))%>%
  group_by(agroclimaticos_ambiente, beneficiaria_si_no)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = agroclimaticos_ambiente, y= prop, fill = beneficiaria_si_no, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Beneficiaria Sí/No"))  + 
  
  ggtitle ("Recolectar y usar datos de lluvia y temperatura para ajustar el riego \n de mi cultivo es lo mejor para el ambiente, por condicion") +
  
  xlab ("") +
  
  ylab ("") +
  
  
    geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.3)  + theme(axis.text.x = element_text(angle =35, hjust = 1))
  
  
```

```{r}

datos %>%
  filter(!is.na(agroclimaticos_descriptiva))%>%
  filter (agroclimaticos_descriptiva == "La mitad" | agroclimaticos_descriptiva == "MÃ¡s de la mitad" | agroclimaticos_descriptiva == "Menos de la mitad" | agroclimaticos_descriptiva == "Ninguno" | agroclimaticos_descriptiva == "Todos") %>%
  group_by(agroclimaticos_descriptiva, beneficiaria_si_no)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = agroclimaticos_descriptiva, y= prop, fill = beneficiaria_si_no, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Beneficiaria Sí/No"))  + 
  
  ggtitle ("¿Cuántos productores de su comunidad recolectan y usan \n datos de lluvia y temperatura para ajustar el riego de su cultivo?") +
  
  xlab ("") +
  
  ylab ("") +
  
  
    geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.3)  + theme(axis.text.x = element_text(angle =35, hjust = 1))
  
  
```

```{r}

datos %>%
  filter(!is.na(especiesnativas_empirica))%>%
  
  group_by(especiesnativas_empirica, beneficiaria_si_no)  %>%
   summarise(n = n()) %>%
  mutate(prop = n/sum(n),upperE=1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n, lowerE=-1.96*sqrt(n/sum(n))*(1-(n/sum(n)))/n) %>%
  
  
  mutate(proporciones= prop.table(n) * 100) %>%
  
ggplot () + aes(x = especiesnativas_empirica, y= prop, fill = beneficiaria_si_no, xlab="") +
  
   geom_bar(stat="identity", width=.5, position = "dodge") +
  
   geom_errorbar(aes(ymin = prop+lowerE, ymax = prop+upperE),width = .2, position=position_dodge(0.5))  + 
  
    guides(fill=guide_legend(title="Beneficiaria Sí/No"))  + 
  
  ggtitle ("Según su opinión, ¿cuántos productores de la comunidad plantan especies \n nativas en las rondas y nacimientos de fuentes de agua normalmente?, \n por condición") +
  
  xlab ("") +
  
  ylab ("") +
  
  
    geom_text(aes(label=paste0("n=", sprintf("%d",n))), nudge_y = -0.3)  + theme(axis.text.x = element_text(angle =35, hjust = 1))
  
  
```





```{r}
datos1 %>%
  count(genero, MUNICIPIO) %>%       
  group_by(MUNICIPIO) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(MUNICIPIO, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) +
     ggtitle("Distribución de beneficiarios por género en cada municipio") +
     theme_bw() +  
     scale_y_discrete(labels=c("", "")) + guides(fill=guide_legend(title="GÉNERO")) +
  scale_y_continuous(expand=c(0,0))
```




Divisiones por género

```{r}
datos1 %>%
  count(genero, MUNICIPIO) %>%       
  group_by(MUNICIPIO) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(MUNICIPIO, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) +
     ggtitle("Distribución de beneficiarios por género en cada municipio") +
     theme_bw() + scale_x_discrete(labels = c('Cubarral','El Castillo', "El Dorado", "Granada", "Lejanías")) +
     scale_y_discrete(labels=c("", "")) + guides(fill=guide_legend(title="GÉNERO"))
```

Divisiones por género completas

```{r}
datos1 %>%
  count(genero, MUNICIPIO) %>%       
  group_by(MUNICIPIO) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(MUNICIPIO, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) +
     ggtitle("Distribución de beneficiarios por género en cada municipio") +
     theme_bw() + scale_x_discrete(labels = c('Cubarral','El Castillo', "El Dorado", "Granada", "Lejanías")) +   guides(fill=guide_legend(title="GÉNERO")) + scale_fill_discrete(labels = c("Femenino", "Masculino"))
```
La desproporción general parece mantenerse por municipio. En el que más paridad de género entre participantes hay es en Lejanías con una distribución 42.9% de personas de género femenino y 57.1% de personas de género masculino.

TENENCIA POR GÉNERO

```{r}
datos1 %>%
  count(genero, tenencia) %>%       
  group_by(tenencia) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(tenencia, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab ("TENENCIA") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) +
     
     theme_bw() 
```

```{r}
datos1 %>%
  count(genero, tenencia) %>%       
  group_by(tenencia) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(tenencia, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab ("TENENCIA") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) +
     ggtitle("Distribución de la tenencia por género") +
     theme_bw() + scale_x_discrete(labels = c('Arrendador','Cosechero', "Propietario")) +   guides(fill=guide_legend(title="GÉNERO")) + scale_fill_discrete(labels = c("Femenino", "Masculino"))
```
Si bien las proporciones de género entre arrendadores parecen ser equilibradas (54.1% de personas de género masculino y 45.9% de personas de género femenino), parece haber grandes disparidades en los propietarios (67.3% de personas de género masculino y 32.7% de personas de género femenino) y sobre todo entre cosecheros (80% de personas de género masculino y 20% de personas de género femenino).

Empero, la  tabla nos muestra que deberíamos tener sospechas sobre estas inferencias

```{r}
table(datos1$tenencia, datos1$genero)
```
Sobre todo para el caso de los 'cosecheros', en donde se cuentan con muy pocas observaciones. 

Para analizar a más profundidad estas diferencias, realizamos una prueba de chi-cuadrado

```{r}
chisq.test(datos1$tenencia, datos1$genero, simulate.p.value = TRUE)
```
Y en efecto, el test nos indica que la evidencia no es suficiente para afirmar una relación entre las variables género y tenencia (no podemos rechazar la hipótesis de que simplemente son independientes).

¿Qué tal si eliminamos los datos de cosecheros?

```{r}
a <- filter(datos1, tenencia == "Arrendador" | tenencia == "Propietario")

```

```{r}
table(a$tenencia, a$genero)
```
```{r}
chisq.test(a$tenencia, a$genero)
```

```{r}
chisq.test(a$tenencia, a$genero, correct = FALSE)
```
Según el test, no encontramos diferencias significativas, no podemos afirmar una asociación entre las variables tenencia y género.

Pero, puede ser un problema de poder (podríamos correr un análisis de poder), o requerir análisis más sofisticados como un modelo logit, usando la tenencia como variable dependiente.

Ahora la relación entre la tenencia y la condición de ser o no beneficiario directo del programa

```{r}
datos %>%
  count(beneficiaria_si_no, tenencia) %>%       
  group_by(tenencia) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(tenencia, proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") 
```

Sin esposa del propietario

```{r}

datos2 <- filter(datos, tenencia == "Arrendador" | tenencia == "Cosechero" | tenencia == "Propietario")

datos2 %>%
  count(beneficiaria_si_no, tenencia) %>%       
  group_by(tenencia) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(tenencia, proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") 
```

```{r}
datos %>%
  count(beneficiaria_si_no, tenencia) %>%       
  group_by(tenencia) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(tenencia, proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab ("TENENCIA") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) +
     ggtitle("Tenencia en función de si se es o no beneficiario directo del programa") +
     theme_bw() + scale_x_discrete(labels = c('Arrendador','Cosechero', "esposa del propietario", "Propietario")) +   guides(fill=guide_legend(title="BENEFICIARIO")) + scale_fill_discrete(labels = c("NO", "SÍ"))
```

```{r}

datos2 <- filter(datos, tenencia == "Arrendador" | tenencia == "Cosechero" | tenencia == "Propietario")

datos2 %>%
  count(beneficiaria_si_no, tenencia) %>%       
  group_by(tenencia) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(tenencia, proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab ("TENENCIA") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) +
     ggtitle("Tenencia en función de si se es o no beneficiario directo del programa") +
     theme_bw() + scale_x_discrete(labels = c('Arrendador','Cosechero', "Propietario")) +   guides(fill=guide_legend(title="BENEFICIARIO")) + scale_fill_discrete(labels = c("NO", "SÍ"))
```






A primera vista, encontramos que en promedio más del 30% de las personas (¿CUÁL ES EL UNIVERSO DE LA MUESTRA, ES UN CENSO O .....?) son beneficiarios directos del programa. Dentro de los beneficiarios, tenemos una mayor representación de propietarios (37.2%), que de arrendadores (33 %) y cosecheros (23.8%).

[¿SACAMOS ESE DATO QUE PARECE SER EXTRAÑO DE LA 'ESPOSA DEL PROPIETARIO', ES UNA CATEGORÍA IMPORTANTE??]


```{r}
table(datos$tenencia, datos$beneficiaria_si_no)
```
Y, en ese contexto, parece importante analizar si hay alguna asociación entre algún tipo de tenecia y el ser o no beneficiario/a directo del proyecto.

```{r}
chisq.test(datos$tenencia, datos$beneficiaria_si_no)
```

```{r}
fisher.test(datos$tenencia, datos$beneficiaria_si_no)
```
Y, no hay una asociación, ambas son independientes (y esto es importante en el contexto del proyecto para poder afirmar que al parecer el tipo de tenencia no tiene incidencia sobre si se es o no beneficiario del proyecto).

Ahora las relaciones entre el nivel educativo, el género y el ser o no beneficiario del proyecto

```{r}
table(datos1$genero, datos1$nivel_educativo)
```


```{r}
datos1 %>%
  count(genero, nivel_educativo) %>%       
  group_by(nivel_educativo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(nivel_educativo, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) 
```
```{r}
datos1 %>%
  count(genero, nivel_educativo) %>%       
  group_by(nivel_educativo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(nivel_educativo, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab ("Nivel educativo") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) +
     ggtitle("Nivel educativo de los beneficiarios del programa por género") +
     theme_bw() + scale_x_discrete(labels = c("Ninguno", "Posgrado", "Primaria", "Profesional", "Secundaria", "Técnico")) +   guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino"))
```
```{r}
a <- table(datos1$nivel_educativo, datos1$genero)
a
```

En la muestra tenemos más personas de género masculino que personas de género femenino y también en casi todos los niveles educativos tenemos más personas de género masculino que personas de género femenino. En los niveles de primaria y secundaria parece haber una mayor proporción de personas de género masculino, y en los niveles profesional y técnico sí parece haber una distribución más equilibrada. 

En el nivel más inferior, el de ninguna educación, hay una mayor distribución de personas de género masculino. En el nivel de posgrado solo encontramos personas de género femenino (si bien solo son dos beneficiarias).

En este sentido, es interesante ver si hay una asociación entre el género y los niveles educativos.

```{r}
fisher.test(datos1$nivel_educativo, datos1$genero)
```

```{r}
CrossTable(datos1$nivel_educativo, datos1$genero, fisher = TRUE, chisq = TRUE, expected = TRUE, sresid = TRUE, format = "SPSS")
```
Con la tabla más sencilla

```{r}
CrossTable(datos1$nivel_educativo, datos1$genero, fisher = TRUE, chisq = TRUE, expected = TRUE, prop.c = FALSE, prop.t = FALSE, prop.chisq = FALSE, sresid = TRUE, format = "SPSS")
```
Sintaxis predictor ~ outcome, entonces mejor género ~ nivel_educativo

```{r}
CrossTable(datos1$genero, datos1$nivel_educativo, fisher = TRUE, chisq = TRUE, expected = TRUE, sresid = TRUE, format = "SPSS")
```

Sí hay una asociación, ¿CUÁL ES? (como hay muchos valores y un desbalance)



```{r}
mosaicplot(a, shade=TRUE, legend=FALSE)
```
food <- c(10, 28)
affection <- c(114, 48)
catsTable <- cbind(food, affection)

```{r}
estudio <- c(84, 148)
no_estudio <- c (1,14)
tabla <- cbind (estudio, no_estudio)
row.names(tabla) <- c("Femenino", "Masculino")
tabla

```

```{r}
f <- as.data.frame(tabla)
colnames (f) <- c("Con estudio", "Sin estudio")

formattable (f,  list('Con estudio' = color_bar(c("#00BFC4", "#F8766D"))) )
```




```{r}
CrossTable(tabla, fisher = TRUE, chisq = TRUE, expected = TRUE, sresid = TRUE, format = "SPSS")
```
Y en efecto encontramos que ser una persona de género femenino hace más probable tener estudios que ser una persona de género masculino (Odds Ratio = 7.9)


## NÚMERO DE HIJOS

```{r}

names(datos)[10] <- 'hijos'
names(datos1)[10] <- 'hijos'

datos <- datos %>% mutate( hijos = as.factor(hijos))
datos1 <- datos1 %>% mutate( hijos = as.factor(hijos))

class(datos$hijos)
class(datos1$hijos)
```

### Hijos Género 

```{r}
datos1$genero <- droplevels(datos1$genero)

datos1$hijos[datos1$hijos == ""] <- "Sin datos"



datos1$hijos <- recode_factor(datos1$hijos, "1"  = "1", "2" = "2", "3" = "3", "4" = "4", 'MÃ¡s' = "Más de 4", 'Ninguno' = "Ninguno", "NA" = "Sin datos")

datos1$hijos <- droplevels(datos1$hijos)

c <- datos1

levels(c$genero) <- c("Femenino", "Masculino")


c1 <- sjt.xtab(c$hijos, #rows
c$genero, show.summary = FALSE, var.labels = c("Número de Hijos", "Género"), show.row.prc = TRUE, file="hijos_genero.doc")

c1


```
Tenemos 50 datos perdidos

```{r}
datos1 %>%
  filter(!is.na(hijos)) %>%
  count(genero, hijos) %>%       
  group_by(hijos) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(hijos, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab ("Hijos") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) +
     ggtitle("Número de hijos divido por género") +
     theme_bw() + guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino"))
```
La gráfica muestra que, en general, hay un mayor porcentaje de personas de género masculino que personas de género femenino en todas las opciones de hijos consideradas. Esto incluye un mayor porcentaje de personas de género masculino sin hijos que personas de género femenino (73.9% vs. 26.1%). Donde encontramos un mayor equilibrio es al considerar los casos de personas de género masculino y femenino con el número más alto de hijos encontrado en la muestra, a saber,  más 4 hijos (51.7% vs. 48.3%).

Empero, conviene analizar si estas diferencias resultan estadísticamente significativas.

```{r}
CrossTable(datos1$genero, datos1$hijos, fisher = TRUE, chisq = TRUE, expected = TRUE, sresid = TRUE, format = "SPSS")
```
El test nos muestra que no podemos afirmar que haya una asociación entre el género y el número de hijos.

### hijos - beneficiario sí no

```{r}

datos$hijos <- recode_factor(datos$hijos, "1"  = "1", "2" = "2", "3" = "3", "4" = "4", 'MÃ¡s' = "Más de 4", 'Ninguno' = "Ninguno", "NA" = "Sin datos")

datos$hijos[datos$hijos == ""] <- "Sin datos"
datos$hijos <- droplevels(datos$hijos)

d1 <- sjt.xtab(datos$hijos, #rows
datos$beneficiaria_si_no, show.summary = FALSE, var.labels = c("Número de Hijos", "Beneficiario"), show.row.prc = TRUE, user.viewer=TRUE, file="hijos_beneficiarios.doc")

d1

```
Contamos con 411 datos perdidos, lo que hace poco interesante ver los análisis más detallados.

### Tipo de cultivo 

### Tipo de cultivo - género

```{r}

names(datos)[13] <- 'tipo_de_cultivo'
names(datos1)[13] <- 'tipo_de_cultivo'

datos <- datos %>% mutate( tipo_de_cultivo = as.factor(tipo_de_cultivo))
datos1 <- datos1 %>% mutate( tipo_de_cultivo = as.factor(tipo_de_cultivo))

class(datos$tipo_de_cultivo)
class(datos1$tipo_de_cultivo)
```
```{r}

datos1$tipo_de_cultivo[datos1$tipo_de_cultivo == ""] <- "Sin datos"

levels(datos1$genero) <- c("Femenino", "Masculino")

datos1$tipo_de_cultivo <- droplevels(datos1$tipo_de_cultivo)


d2 <- sjt.xtab(datos1$tipo_de_cultivo, #rows
datos1$genero, show.summary = FALSE, show.row.prc = TRUE, user.viewer=TRUE, var.labels = c("Tipo de cultivo", "Género"), file = "genero_cultivo.doc")

d2

```

```{r}
datos1 %>% 
  filter(!is.na(tipo_de_cultivo)) %>%
  count(genero, tipo_de_cultivo) %>%       
  group_by(tipo_de_cultivo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(tipo_de_cultivo, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab ("Tipo de cultivo") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + ggtitle("Distribución de género por tipo de cultivo") +
     theme_bw()  +   guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino"))
```
La gráfica nos indica una mayor proporción de personas de género masculino que de género femenino en los diferentes tipos de cultivo, especialmente en los cultivos transitorios (72.7% vs. 27.3%). 

```{r}
CrossTable(datos1$tipo_de_cultivo, datos1$genero, fisher = TRUE, chisq = TRUE, expected = TRUE, sresid = TRUE, format = "SPSS")
```
Empero, el test nos muestra que no podemos afirmar que haya una asociaciación entre el género y el tipo de cultivo y que las diferencias porcentuales anteriormente vistas pueden deberse solo al desbalance de género que hay en la muestra.

### Tipo de cultivo - beneficiario

```{r}

datos$tipo_de_cultivo[datos$tipo_de_cultivo == ""] <- "Sin datos"

datos$tipo_de_cultivo <- droplevels(datos$tipo_de_cultivo)

d3 <- sjt.xtab(datos$tipo_de_cultivo, #rows
datos$beneficiaria_si_no, show.summary = FALSE, show.row.prc = TRUE, user.viewer=TRUE, var.labels = c("Tipo de cultivo", "Beneficiario"), file="tipo_cultivo_beneficiario.doc")

d3

```

```{r}
datos %>%  
  filter(!is.na(tipo_de_cultivo)) %>%
  count(beneficiaria_si_no, tipo_de_cultivo) %>%       
  group_by(tipo_de_cultivo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(tipo_de_cultivo, proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Tipo de cultivo") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5))  +
     ggtitle("Distribución de beneficiarios por tipo de cultivo") +
     theme_bw() + guides(fill=guide_legend(title="Beneficiario")) + scale_fill_discrete(labels = c("No", "Sí"))
```
La gráfica parece indicar que hay una mayor proporción de beneficiarios del programa, comparados con los que no son beneficiarios, con cultivos permanentes (74.8% vs. 25.2%) y con cultivos tanto permanentes como transitorios (73.9% vs. 26.1%), mientras que existe una mayor proporción de personas con cultivos transitorios entre los no-beneficiarios del programa (54.2% vs. 45.8%).

```{r}
CrossTable(datos$tipo_de_cultivo, datos$beneficiaria_si_no, fisher = TRUE, chisq = TRUE, expected = TRUE, sresid = TRUE, format = "SPSS")
```
Y en efecto, sí parece poderse inferir esta asociación entre tipo de cultivo y pertenencia o no al programa. Esto es importante a la hora, de analizar los mecanismos de reclutamiento-integración al programa, en función, tanto de evitar sesgos de selección, como de identificar por qué el programa parece más atractivo a personas con cultivos permanentes, para fortalecer este aspecto y, posiblemente, fortalecer la motivación de las personas con cultivos transitorios para pertenecer al mismo.

### TIPO ASISTENCIA TÉCNICA

### asistencia técnica - género


```{r}

names(datos)[20] <- 'tipo_asistencia_técnica'
names(datos1)[20] <- 'tipo_asistencia_técnica'

datos <- datos %>% mutate( tipo_asistencia_técnica = as.factor(tipo_asistencia_técnica))
datos1 <- datos1 %>% mutate( tipo_asistencia_técnica = as.factor(tipo_asistencia_técnica))

class(datos$tipo_asistencia_técnica)
class(datos1$tipo_asistencia_técnica)
```
la tabla

```{r}

datos1$tipo_asistencia_técnica <- recode_factor(datos1$tipo_asistencia_técnica, "No aplica"  = "Datos faltantes", "Otra" = "Otra", "Presencial" = "Presencial", "TelefÃ³nica" = "Telefónica", 'WhatsApp' = "WhatsApp")

d4 <- sjt.xtab(datos1$tipo_asistencia_técnica, #rows
datos1$genero, show.summary = FALSE, show.row.prc = TRUE, var.labels=c("Tipo de asistencia técnica", "Género"), file="genero_asistencia_tecnica.doc")

d4


```

La tabla nos muestra que no hay suficientes datos para hacer un análisis concluyente entre la relación entre el género y el tipo de asistencia técnica recibida: no contamos con datos de 124 personas (de una muestra de 247), y, de los 123 restantes, 117 (el 95%) recibieron asistencia presencial.

```{r}

datos$tipo_asistencia_técnica <- recode_factor(datos$tipo_asistencia_técnica, "No aplica"  = "Datos faltantes", "Otra" = "Otra", "Presencial" = "Presencial", "TelefÃ³nica" = "Telefónica", 'WhatsApp' = "WhatsApp")

d5 <- sjt.xtab(datos$tipo_asistencia_técnica, #rows
datos$beneficiaria_si_no, show.summary = FALSE, show.row.prc = TRUE, var.labels=c("Tipo de asistencia técnica", "Beneficiario"), file="beneficiaria_asistencia_tecnica.doc")

d5
```

Algo similar sucede con los datos desagrados por si las personas son o no beneficiarias del programa. No contamos con datos de 384 personas en una muestrade 685, y, de las 301 restantes, 288 (el 96%) recibieron asistencia presencial.

### HACE CUÁNTO EL ANÁLISIS DE SUELO

### Género

```{r}

names(datos)[22] <- 'cuanto_analisis_suelo'
names(datos1)[22] <- 'cuanto_analisis_suelo'

datos <- datos %>% mutate( cuanto_analisis_suelo = as.factor(cuanto_analisis_suelo))
datos1 <- datos1 %>% mutate( cuanto_analisis_suelo = as.factor(cuanto_analisis_suelo))

class(datos$cuanto_analisis_suelo)
class(datos1$cuanto_analisis_suelo)
```

```{r}

datos1$cuanto_analisis_suelo <- recode_factor(datos1$cuanto_analisis_suelo, "Entre 1 y 2 aÃ±os"  = "Entre 1 y 2 años", "Hace mÃ¡s de 3 aÃ±os" = "Hace más de 3 años", "Menos de 1 aÃ±o" = "Menos de 1 año", "Nunca ha hecho un anÃ¡lisis de suelo" = "Nunca")

d6 <- sjt.xtab(datos1$cuanto_analisis_suelo, #rows
datos1$genero, show.summary = FALSE, var.labels = c("¿Hace cuánto realizó el último análisis de suelo?", "Género"), show.row.prc = TRUE, file = "genero_cuanto_suelo.doc")

d6


```

```{r}
datos1 %>%
  count(genero, cuanto_analisis_suelo) %>%       
  group_by(cuanto_analisis_suelo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(cuanto_analisis_suelo, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Hace cuánto realizó el último análisis de suelo?") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) +
     ggtitle("Hace cuánto se ha realizado el último análisis de suelo dividido por género") +
     theme_bw() + guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino"))
```
Como es usual, y en parte ligado a que la muestra tiene un número significamente mayor de personas de género masculino que personas de género femenino, en todas las opciones tenemos más personas de género masculino que femenino. Podría ser interesante notar que dentro de las personas que realizaron el último estudio de suelo hace más de tres años hay una proporción mucho más alta de personas de género masculino que de personas de género femenino (74.6% vs. 65.3%).

Para explorar este efecto realizamos un análisis más detallado.

```{r}

model1 <- multinom(cuanto_analisis_suelo ~ genero, data=datos1)
summary (model1)

odds1 <- exp(coef(model1))
odds1

zvalues1 <- summary(model1)$coefficients / summary(model1)$standard.errors
p.values1 <- pnorm(abs(zvalues1), lower.tail=FALSE)*2
p.values1

```
El modelo nos muestra que no tenemos evidencia para sostener que hay una asociación entre el género y hace cuánto hicieron su último estudio de suelo en ninguno de los niveles considerados (todos los p values asociados son mayores al alpha de referencia de 0.05).

```{r}
datos$cuanto_analisis_suelo <- recode_factor(datos$cuanto_analisis_suelo, "Entre 1 y 2 aÃ±os"  = "Entre 1 y 2 años", "Hace mÃ¡s de 3 aÃ±os" = "Hace más de 3 años", "Menos de 1 aÃ±o" = "Menos de 1 año", "Nunca ha hecho un anÃ¡lisis de suelo" = "Nunca")

d7 <- sjt.xtab(datos$cuanto_analisis_suelo, #rows
datos$beneficiaria_si_no, show.summary = FALSE, var.labels = c("¿Hace cuánto realizó el último análisis de suelo?", "Beneficiario"), show.row.prc = TRUE, file = "beneficiaria_cuanto_suelo.doc")

d7
```

## vale la pena análisis de suelos

```{r}
names(datos)[25] <- 'fertiliza_analisis'
names(datos1)[25] <- 'fertiliza_analisis'

datos <- datos %>% mutate( fertiliza_analisis = as.factor(fertiliza_analisis))
datos1 <- datos1 %>% mutate( fertiliza_analisis = as.factor(fertiliza_analisis))

class(datos$fertiliza_analisis)
class(datos1$fertiliza_analisis)
```


```{r}
datos1 %>%
  count(genero, cuanto_analisis_suelo) %>%       
  group_by(cuanto_analisis_suelo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(cuanto_analisis_suelo, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Hace cuánto realizó el último análisis de suelo?") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) +
     ggtitle("Hace cuánto se ha realizado el último análisis de suelo dividido por género") +
     theme_bw() + guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino"))
```



```{r}
datos %>%
  count(beneficiaria_si_no, cuanto_analisis_suelo) %>%       
  group_by(cuanto_analisis_suelo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(cuanto_analisis_suelo, proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Hace cuánto realizó el último análisis de suelo?") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) +
     ggtitle("Hace cuánto se ha realizado el último análisis de suelo \n dividido por si se es o no beneficiario") +
     theme_bw() + guides(fill=guide_legend(title="Beneficiario")) + scale_fill_discrete(labels = c("No", "Sí"))
```
Está gráfica parece sugerir un patrón en el que las personas que no son beneficiarias del programa, de manera mayoritaria, nunca han realizado un estudio de suelos o han realizado el último hace más de un año, mientras que las personas beneficiarias del programa mayoritariamente manifiestan haberlo realizado en el último año.

```{r}

model2 <- multinom(cuanto_analisis_suelo ~ beneficiaria_si_no, data=datos)
summary (model2)

odds2 <- exp(coef(model2))
odds2

zvalues2 <- summary(model2)$coefficients / summary(model1)$standard.errors
p.values2 <- pnorm(abs(zvalues2), lower.tail=FALSE)*2
p.values2

```

En efecto encontramos que ser beneficiario del programa está asociado a una probabilidad 10 veces mayor de tener un estudio de suelo en el último año, comparado con las personas que no son beneficiarias. Las otras asociaciones no resultaron significativas. Esto puede indicar que los beneficiarios del programa están teniendo de entrada una predisposición a guiarse por los análisis de suelo, lo que puede, de entrada, favorecer varios objetivos del proyecto.

### Sabe leer análisis de suelos

### genero_leer_suelos

```{r}

names(datos)[23] <- 'leer_suelos'
names(datos1)[23] <- 'leer_suelos'

datos <- datos %>% mutate( leer_suelos = as.factor(leer_suelos))
datos1 <- datos1 %>% mutate( leer_suelos = as.factor(leer_suelos))

class(datos$leer_suelos)
class(datos1$leer_suelos)
```
```{r}

datos1$leer_suelos[datos1$leer_suelos == ""] <- "Sin datos"

datos1$leer_suelos <- recode_factor(datos1$leer_suelos, "No"  = "No", "SÃ­" = "Sí", "Tengo algunas dudas" = "Tengo algunas dudas", "NA" = "Sin datos")

datos1$leer_suelos <- droplevels(datos1$leer_suelos)


d8 <- sjt.xtab(datos1$leer_suelos, #rows
datos1$genero, show.summary = FALSE,  var.labels = c("¿Sabe leer el análisis de suelos?", "Género"), show.row.prc = TRUE, file = "genero_leer_suelos.doc")

d8


```
```{r}
datos1 %>% 
  filter(!is.na(leer_suelos)) %>%
  count(genero, leer_suelos) %>%       
  group_by(leer_suelos) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(leer_suelos, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Sabe leer el análisis de suelos para comprar \n los insumos correctos (cantidad y tipo)?") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) +
     ggtitle("Conocimiento del análisis de suelos para comprar \n los insumos correctos (cantidad y tipo)") +
     theme_bw() + guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino"))
```
La gráfica parece indicar un mayor proporción de personas de género masculino que manifiestan saber leer el análisis de suelos para comprar la cantidad y tipo de insumos adecuados para mejorar su producción.

```{r}

model3 <- multinom(leer_suelos ~ genero, data=datos1)
summary (model3)

odds3 <- exp(coef(model3))
odds3

zvalues3 <- summary(model3)$coefficients / summary(model3)$standard.errors
p.values3 <- pnorm(abs(zvalues3), lower.tail=FALSE)*2
p.values3

```

Empero, el modelo nos muestra que no podemos afirmar una asociación entre el género y el conocimiento para leer el análisis de suelos.

### leer suelos y beneficiario

```{r}

datos$leer_suelos[datos$leer_suelos == ""] <- "Sin datos"

datos$leer_suelos <- recode_factor(datos$leer_suelos, "No"  = "No", "SÃ­" = "Sí", "Tengo algunas dudas" = "Tengo algunas dudas", "NA" = "Sin datos")

datos$leer_suelos <- droplevels(datos$leer_suelos)


d9 <- sjt.xtab(datos$leer_suelos, #rows
datos$beneficiaria_si_no, show.summary = FALSE, show.row.prc = TRUE, var.labels = c("¿Sabe leer el análisis de suelos?", "Beneficiario"), file="leer_suelos_beneficiario.doc")

d9


```
```{r}
datos %>% filter(!is.na(leer_suelos)) %>%
  count(beneficiaria_si_no, leer_suelos) %>%       
  group_by(leer_suelos) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(leer_suelos, proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Sabe leer el análisis de suelos para comprar \n los insumos adecuados(cantidad/tipo)?") +
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) +
     ggtitle("Conocimiento del análisis de suelos para comprar \n los insumos adecuados (cantidad/tipo)") +
     theme_bw() + guides(fill=guide_legend(title="Beneficiario")) + scale_fill_discrete(labels = c("No", "Sí"))
```
Las personas que son beneficiarios del programa tienen una mayor proporción en todas las categorías, especialmente en la de tener algunas dudas al leer el análisis de suelos.



```{r}

model4 <- multinom(leer_suelos ~ beneficiaria_si_no, data=datos)
summary (model4)

odds4 <- exp(coef(model4))
odds4

zvalues4 <- summary(model4)$coefficients / summary(model4)$standard.errors
p.values4 <- pnorm(abs(zvalues4), lower.tail=FALSE)*2
p.values4

```

Empero el modelo muestra que no hay diferencias signficativas entre el ser o no beneficiario y el tener o no conocimiento del análisis de suelos. Sirve a ambas poblaciones y sería comparable.

### VALE LA PENA HACER ANÁLISIS DE SUELOS

### valioso_suelos género

```{r}

names(datos)[24] <- 'valioso_analisis_suelo'
names(datos1)[24] <- 'valioso_analisis_suelo'

datos <- datos %>% mutate( valioso_analisis_suelo = as.factor(valioso_analisis_suelo))
datos1 <- datos1 %>% mutate( valioso_analisis_suelo = as.factor(valioso_analisis_suelo))

class(datos$valioso_analisis_suelo)
class(datos1$valioso_analisis_suelo)
```
```{r}


d10 <- sjt.xtab(datos1$valioso_analisis_suelo, #rows
datos1$genero, show.summary = FALSE, show.row.prc = TRUE, var.labels = c("¿Vale la pena hacer un análisis de suelo al menos cada 3 años?", "Género"), file = "valioso_suelo_genero.doc")

d10


```

```{r}
datos1$valioso_analisis_suelo[datos1$valioso_analisis_suelo == ""] <- "Sin datos"

datos1$valioso_analisis_suelo <- recode_factor(datos1$valioso_analisis_suelo, "NA" = "Sin datos")



datos1 %>% filter(!is.na(valioso_analisis_suelo)) %>%
  count(genero, valioso_analisis_suelo) %>%       
  group_by(valioso_analisis_suelo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(valioso_analisis_suelo, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Vale la pena hacer un análisis de suelo al menos cada 3 años?")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + guides(fill=guide_legend(title="Género")) + theme(axis.text.x = element_text(angle =35, hjust = 1))
```
 
```{r}
datos1$valioso_analisis_suelo[datos1$valioso_analisis_suelo == ""] <- "Sin datos"

datos1$valioso_analisis_suelo <- recode_factor(datos1$valioso_analisis_suelo, "NA" = "Sin datos")



datos1 %>% filter(!is.na(valioso_analisis_suelo)) %>%
  count(genero, valioso_analisis_suelo) %>%       
  group_by(valioso_analisis_suelo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(valioso_analisis_suelo, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Vale la pena hacer un análisis de suelo al menos cada 3 años?")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + scale_fill_discrete(labels = c("Femenino", "Masculino")) + guides(fill=guide_legend(title="Género")) + scale_x_discrete(guide = guide_axis(n.dodge=2))
```

Encontramos dos opciones con 100% de personas de género masculino ('Completamente en desacuerdo' y 'Ni de acuerdo ni en desacuerdo'), empero estas opciones solo cuentan con dos personas y por ende no parece ser muy representativo. De manera similar, en la opción 'En desacuerdo' encontramos un equilibrio de personas de ambos géneros, si bien esta opción también cuenta con muy pocas personas como representantes. En las opciones en donde se tienen datos que parecen ser más significativos ('Completamente de acuerdo' y 'De acuerdo'), que son las que manifiestan un acuerdo con la idea de que es valioso hacer un análisis de suelo al menos cada 3 años, parece existir una mayor proporción de personas de género masculino que personas de género femenino (60.6% y 66.9% vs. 39.4% y 33.1%).

Por eso se hace un análisis más detallado

```{r}

model5 <- multinom(valioso_analisis_suelo ~ genero, data=datos1)
summary (model5)

odds5 <- exp(coef(model5))
odds5

zvalues5 <- summary(model5)$coefficients / summary(model5)$standard.errors
p.values5 <- pnorm(abs(zvalues5), lower.tail=FALSE)*2
p.values5

```
Con solo las variables de interés

```{r}

b <- filter (datos1, valioso_analisis_suelo == "Completamente de acuerdo" | valioso_analisis_suelo == "De acuerdo")

b$valioso_analisis_suelo <- droplevels(b$valioso_analisis_suelo)

model6 <- multinom(valioso_analisis_suelo ~ genero, data=b)
summary (model6)

odds6 <- exp(coef(model6))
odds6

zvalues6 <- summary(model6)$coefficients / summary(model6)$standard.errors
p.values6 <- pnorm(abs(zvalues6), lower.tail=FALSE)*2
p.values6

```
Empero, no hay diferencias significativas en género.

### beneficiario - valioso_suelo

```{r}


d11 <- sjt.xtab(datos$valioso_analisis_suelo, #rows
datos$beneficiaria_si_no, show.summary = FALSE, show.row.prc = TRUE, var.labels = c("¿Vale la pena hacer un análisis de suelo al menos cada 3 años?", "Beneficiario"), file = "valioso_suelo_beneficiario.doc")

d11


```

```{r}
datos$valioso_analisis_suelo[datos$valioso_analisis_suelo == ""] <- "Sin datos"

datos$valioso_analisis_suelo <- recode_factor(datos$valioso_analisis_suelo, "NA" = "Sin datos")



datos %>% filter(!is.na(valioso_analisis_suelo)) %>%
  count(beneficiaria_si_no, valioso_analisis_suelo) %>%       
  group_by(valioso_analisis_suelo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(valioso_analisis_suelo, proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Vale la pena hacer un análisis de suelo al menos cada 3 años?")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + scale_x_discrete(guide = guide_axis(n.dodge=2))

```


```{r}
datos$valioso_analisis_suelo[datos$valioso_analisis_suelo == ""] <- "Sin datos"

datos$valioso_analisis_suelo <- recode_factor(datos$valioso_analisis_suelo, "NA" = "Sin datos")



datos %>% filter(!is.na(valioso_analisis_suelo)) %>%
  count(beneficiaria_si_no, valioso_analisis_suelo) %>%       
  group_by(valioso_analisis_suelo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(valioso_analisis_suelo, proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Vale la pena hacer un análisis de suelo al menos cada 3 años?")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + theme(axis.text.x = element_text(angle =35, hjust = 1))

```
La gráfica muestra que, al parecer, las personas que no son beneficiarias del programa podrían estar más de acuerdo y completamente de acuerdo con que es valioso hacer un análisis de suelo al menos cada 3 años que los beneficiarios (64.8 y 56.2%), si bien al mismo tiempo serían los que están más en desacuerdo (71.4). Además, que las personas beneficiarias estarían más completamente en desacuerdo con lo valioso de este análisis (66.7%). Por último, los no-beneficiarios son los más indiferentes al respecto.

```{r}


model7 <- multinom(valioso_analisis_suelo ~ beneficiaria_si_no, data=datos)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```
En un análisis más detallado se encuentra que ser beneficiario reduce ligeramente la probabilidad de estar de acuerdo en que el análisis de suelo es valioso (OR= 0.69), así como reduce la probabilidad de ser indiferente (OR= 0.08). 


### fertiliza con base en los análisis de suelo - género

```{r}

names(datos)[25] <- 'fertiliza_analisis'
names(datos1)[25] <- 'fertiliza_analisis'

datos <- datos %>% mutate( fertiliza_analisis = as.factor(fertiliza_analisis))
datos1 <- datos1 %>% mutate( fertiliza_analisis = as.factor(fertiliza_analisis))

class(datos$fertiliza_analisis)
class(datos1$fertiliza_analisis)
```

```{r}

datos1$fertiliza_analisis <- recode_factor(datos1$fertiliza_analisis,"SÃ­" = "Sí")

d12 <- sjt.xtab(datos1$fertiliza_analisis, #rows
datos1$genero, show.summary = FALSE, show.row.prc = TRUE,  var.labels = c("Fertiliza con base en los resultados de un análisis de suelo?", "Género"))

d12


```

```{r}
datos1$fertiliza_analisis[datos1$fertiliza_analisis == ""] <- "Sin datos"

datos1$fertiliza_analisis <- recode_factor(datos1$fertiliza_analisis, "NA" = "Sin datos")



datos1 %>% filter(!is.na(fertiliza_analisis)) %>%
  count(genero, fertiliza_analisis) %>%       
  group_by(fertiliza_analisis) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(fertiliza_analisis, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Fertiliza con base en un análisis de suelo?")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Género")) 

```
La gráfica nos muestra una mayor proporción de personas de género masculino, comparadas con personas de género femenino, tanto que fertilizan como que no fertilizan basándose en un análisis de suelo (71.3% y 61.8%).

Un análisis más detallado muestra que 



```{r}


model8 <- multinom(fertiliza_analisis ~ genero, data=datos1)
summary (model8)

odds8 <- exp(coef(model8))
odds8

zvalues8 <- summary(model8)$coefficients / summary(model8)$standard.errors
p.values8 <- pnorm(abs(zvalues8), lower.tail=FALSE)*2
p.values8

```

Si bien no se encuentra una diferencia de género significativa.


### fertiliza basado en análisis - beneficiario


```{r}

datos$fertiliza_analisis <- recode_factor(datos$fertiliza_analisis,"SÃ­" = "Sí")

d13 <- sjt.xtab(datos$fertiliza_analisis, #rows
datos$beneficiaria_si_no, show.summary = FALSE, show.row.prc = TRUE,  var.labels = c("Fertiliza con base en los resultados de un análisis de suelo?", "Beneficiario"), file="fertiliza_analisis_beneficiario.doc")

d13


```



```{r}
datos$fertiliza_analisis[datos$fertiliza_analisis == ""] <- "Sin datos"

datos$fertiliza_analisis <- recode_factor(datos$fertiliza_analisis, "NA" = "Sin datos")



datos %>% filter(!is.na(fertiliza_analisis)) %>%
  count(beneficiaria_si_no, fertiliza_analisis) %>%       
  group_by(fertiliza_analisis) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(fertiliza_analisis, proporciones, fill= beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Fertiliza con base en un análisis de suelo?")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) 

```
La gráfica indica una mayor proporción de personas que no son beneficiarios tanto que no fertilizan como sí fertilizan usando un análisis de suelo.



```{r}


model9 <- multinom(fertiliza_analisis ~ beneficiaria_si_no, data=datos)
summary (model9)

odds9 <- exp(coef(model9))
odds9

zvalues9 <- summary(model9)$coefficients / summary(model9)$standard.errors
p.values9 <- pnorm(abs(zvalues9), lower.tail=FALSE)*2
p.values9

```

Empero la diferencia no es significativa.


### Fertilizar basado en análisis es lo mejor

```{r}

names(datos)[28] <- 'fertilizar_analizar_mejor_yo'
names(datos1)[28] <- 'fertilizar_analizar_mejor_yo'

datos <- datos %>% mutate( fertilizar_analizar_mejor_yo = as.factor(fertilizar_analizar_mejor_yo))
datos1 <- datos1 %>% mutate( fertilizar_analizar_mejor_yo = as.factor(fertilizar_analizar_mejor_yo))

class(datos$fertilizar_analizar_mejor_yo)
class(datos1$fertilizar_analizar_mejor_yo)
```

```{r}
datos1$fertilizar_analizar_mejor_yo[datos1$fertilizar_analizar_mejor_yo == ""] <- "Sin datos"

datos1$fertilizar_analizar_mejor_yo <- recode_factor(datos1$fertilizar_analizar_mejor_yo, "NA" = "Sin datos")



datos1 %>% filter(!is.na(fertilizar_analizar_mejor_yo)) %>%
  count(genero, fertilizar_analizar_mejor_yo) %>%       
  group_by(fertilizar_analizar_mejor_yo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(fertilizar_analizar_mejor_yo, proporciones, fill= genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Fertilizar basado en un análisis de suelo es lo mejor para mí y mi familia")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + theme(axis.text.x = element_text(angle =35, hjust = 1)) + guides(fill=guide_legend(title="Género")) + scale_fill_discrete(labels = c("Femenino", "Masculino"))

```
```{r}

datos1$genero[datos1$genero == ""] <- "Sin datos"

datos1$genero <- recode_factor(datos1$genero,"NA" = "Sin datos")

datos1$genero <- droplevels(datos1$genero)

model40 <- multinom(fertilizar_analizar_mejor_yo ~ genero, data=datos1)
summary (model40)

odds40 <- exp(coef(model40))
odds40

zvalues40 <- summary(model40)$coefficients / summary(model40)$standard.errors
p.values40 <- pnorm(abs(zvalues40), lower.tail=FALSE)*2
p.values40
```

```{r}
datos$fertilizar_analizar_mejor_yo[datos$fertilizar_analizar_mejor_yo == ""] <- "Sin datos"

datos$fertilizar_analizar_mejor_yo <- recode_factor(datos$fertilizar_analizar_mejor_yo, "NA" = "Sin datos")



datos %>% filter(!is.na(fertilizar_analizar_mejor_yo)) %>%
  count(beneficiaria_si_no, fertilizar_analizar_mejor_yo) %>%       
  group_by(fertilizar_analizar_mejor_yo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(fertilizar_analizar_mejor_yo, proporciones, fill= beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Fertilizar basado en un análisis de suelo es lo mejor para mí y mi familia")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + theme(axis.text.x = element_text(angle =35, hjust = 1)) + guides(fill=guide_legend(title="Beneficiario")) 
```

```{r}


model41 <- multinom(fertilizar_analizar_mejor_yo ~ beneficiaria_si_no, data=datos)
summary (model41)

odds41 <- exp(coef(model41))
odds41

zvalues41 <- summary(model41)$coefficients / summary(model41)$standard.errors
p.values41 <- pnorm(abs(zvalues41), lower.tail=FALSE)*2
p.values41
```

### fertilizar_analisis_mejor, género

```{r}

names(datos)[27] <- 'fertilizar_analizar_mejor_ambiente'
names(datos1)[27] <- 'fertilizar_analizar_mejor_ambiente'

datos <- datos %>% mutate( fertilizar_analizar_mejor_ambiente = as.factor(fertilizar_analizar_mejor_ambiente))
datos1 <- datos1 %>% mutate( fertilizar_analizar_mejor = as.factor(fertilizar_analizar_mejor_ambiente))

class(datos$fertilizar_analizar_mejor_ambiente)
class(datos1$fertilizar_analizar_mejor_ambiente)
```


```{r}

d14 <- sjt.xtab(datos1$fertilizar_analizar_mejor_ambiente, #rows
datos1$genero, show.summary = FALSE, show.row.prc = TRUE,  var.labels = c("Fertilizar con base en los resultados de un análisis de suelo es lo mejor para el ambiente", "Género"), file="fertilizar_mejor_ambiente_genero.doc")

d14


```



```{r}
datos1$fertilizar_analizar_mejor_ambiente[datos1$fertilizar_analizar_mejor_ambiente == ""] <- "Sin datos"

datos1$fertilizar_analizar_mejor_ambiente <- recode_factor(datos1$fertilizar_analizar_mejor_ambiente, "NA" = "Sin datos")



datos1 %>% filter(!is.na(fertilizar_analizar_mejor_ambiente)) %>%
  count(genero, fertilizar_analizar_mejor_ambiente) %>%       
  group_by(fertilizar_analizar_mejor_ambiente) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(fertilizar_analizar_mejor_ambiente, proporciones, fill= genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Fertilizar basado en un análisis de suelo es lo mejor para el ambiente")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + theme(axis.text.x = element_text(angle =35, hjust = 1)) + guides(fill=guide_legend(title="Género"))

```
Parece haber muy pocas personas en las categorías 'Completamente en desacuerdo', 'En desacuerdo' y 'Ni de acuerdo ni en desacuerdo' (5, 10 y 9 respectivamente), por ende no parece importante analizar sus resultados. En las categorías de 'Completamente de acuerdo' y 'De acuerdo' parece haber una proporción mayor de personas de género masculino (73.3% y 63.3%), posiblemente indicando que las personas de este género tienden en mayor manera a considerar que la fertilización basada en análisis de suelos es lo mejor para el ambiente.


```{r}


model10 <- multinom(fertilizar_analizar_mejor_ambiente ~ genero, data=datos1)
summary (model10)

odds10 <- exp(coef(model10))
odds10

zvalues10 <- summary(model10)$coefficients / summary(model10)$standard.errors
p.values10 <- pnorm(abs(zvalues10), lower.tail=FALSE)*2
p.values10

```

Empero no hay diferencias significativas.


### fertilizar_analisis_mejor_ambiente, beneficiario


```{r}

datos$fertilizar_analizar_mejor_ambiente[datos$fertilizar_analizar_mejor_ambiente == ""] <- "Sin datos"

datos$fertilizar_analizar_mejor_ambiente <- recode_factor(datos$fertilizar_analizar_mejor_ambiente,"NA" = "Sin datos")

datos$fertilizar_analizar_mejor_ambiente <- droplevels(datos$fertilizar_analizar_mejor_ambiente)

d15 <- sjt.xtab(datos$fertilizar_analizar_mejor_ambiente, #rows
datos$beneficiaria_si_no, show.summary = FALSE, show.row.prc = TRUE, var.labels = c("Fertilizar con base en los resultados de un análisis de suelo es lo mejor para el ambiente", "Beneficiario"), file="fertilizar_mejor_ambiente_beneficiario.doc")

d15


```



```{r}

datos %>% filter(!is.na(fertilizar_analizar_mejor_ambiente)) %>%
  count(beneficiaria_si_no, fertilizar_analizar_mejor_ambiente) %>%       
  group_by(fertilizar_analizar_mejor_ambiente) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(fertilizar_analizar_mejor_ambiente, proporciones, fill= beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Fertilizar basado en un análisis de suelo es lo mejor para el ambiente")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + theme(axis.text.x = element_text(angle =35, hjust = 1)) + guides(fill=guide_legend(title="Beneficiario"))

```
Parece haber muy pocas personas en las categorías 'Completamente en desacuerdo', 'En desacuerdo' y 'Ni de acuerdo ni en desacuerdo' (5, 32 y 45 respectivamente), por ende no parece importante analizar sus resultados. En las categorías de 'Completamente de acuerdo' y 'De acuerdo' parece haber una proporción mayor de personas que no son beneficiarias del programa (64.6% y 62.7%), posiblemente indicando que las personas que no son beneficiarias del programa tienden en mayor manera a considerar que la fertilización basada en análisis de suelos es lo mejor para el ambiente.


```{r}


model11 <- multinom(fertilizar_analizar_mejor_ambiente ~ beneficiaria_si_no, data=datos)
summary (model11)

odds11 <- exp(coef(model11))
odds11

zvalues11 <- summary(model11)$coefficients / summary(model11)$standard.errors
p.values11 <- pnorm(abs(zvalues11), lower.tail=FALSE)*2
p.values11

```
Empero, no hay diferencias significativas.

### Fertilizar basado en un análisis de suelos es lo mejor para mi comunidad

### fertilizar_analizar_mejor_comunidad, género



```{r}

names(datos)[29] <- 'fertilizar_analizar_mejor_comunidad'
names(datos1)[29] <- 'fertilizar_analizar_mejor_comunidad'

datos <- datos %>% mutate( fertilizar_analizar_mejor_comunidad = as.factor(fertilizar_analizar_mejor_comunidad))
datos1 <- datos1 %>% mutate( fertilizar_analizar_mejor_comunidad = as.factor(fertilizar_analizar_mejor_comunidad))

class(datos$fertilizar_analizar_mejor_comunidad)
class(datos1$fertilizar_analizar_mejor_comunidad)
```


```{r}

d16 <- sjt.xtab(datos1$fertilizar_analizar_mejor_comunidad, #rows
datos1$genero, show.summary = FALSE, show.row.prc = TRUE,  var.labels = c("Fertilizar con base en los resultados de un análisis de suelo es lo mejor para mi comunidad", "Género"), file="fertilizar_mejor_comunidad.doc")

d16


```



```{r}
datos1$fertilizar_analizar_mejor_comunidad[datos1$fertilizar_analizar_mejor_comunidad == ""] <- "Sin datos"

datos1$fertilizar_analizar_mejor_comunidad <- recode_factor(datos1$fertilizar_analizar_mejor_comunidad, "NA" = "Sin datos")



datos1 %>% filter(!is.na(fertilizar_analizar_mejor_comunidad)) %>%
  count(genero, fertilizar_analizar_mejor_comunidad) %>%       
  group_by(fertilizar_analizar_mejor_comunidad) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(fertilizar_analizar_mejor_comunidad, proporciones, fill= genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Fertilizar basado en un análisis de suelo es lo mejor para el ambiente")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + theme(axis.text.x = element_text(angle =35, hjust = 1)) + guides(fill=guide_legend(title="Género"))

```
Parece haber muy pocas personas en las categorías 'Completamente en desacuerdo', 'En desacuerdo' y 'Ni de acuerdo ni en desacuerdo' (7, 13, y 8 respectivamente), por ende no parece importante analizar sus resultados. En las categorías de 'Completamente de acuerdo' y 'De acuerdo' parece haber una proporción mayor de personas de género masculino (72.3% y 64.3%), posiblemente indicando que las personas de este género tienden en mayor manera a considerar que la fertilización basada en análisis de suelos es lo mejor para su comunidad.


```{r}


model12 <- multinom(fertilizar_analizar_mejor_comunidad ~ genero, data=datos1)
summary (model12)

odds12 <- exp(coef(model12))
odds12

zvalues12 <- summary(model12)$coefficients / summary(model12)$standard.errors
p.values12 <- pnorm(abs(zvalues12), lower.tail=FALSE)*2
p.values12

```

Empero, las diferencias no resultan significativas.


### fertilizar_analisis_mejor_comunidad, beneficiario


```{r}

datos$fertilizar_analizar_mejor_comunidad[datos$fertilizar_analizar_mejor_comunidad == ""] <- "Sin datos"

datos$fertilizar_analizar_mejor_comunidad <- recode_factor(datos$fertilizar_analizar_mejor_comunidad,"NA" = "Sin datos")

datos$fertilizar_analizar_mejor_comunidad <- droplevels(datos$fertilizar_analizar_mejor_comunidad)

d17 <- sjt.xtab(datos$fertilizar_analizar_mejor_comunidad, #rows
datos$beneficiaria_si_no, show.summary = FALSE, show.row.prc = TRUE, var.labels = c("Fertilizar con base en los resultados de un análisis de suelo es lo mejor para mi comunidad", "Beneficiario"), file="fertilizar_mejor_ambiente_comunidad.doc")

d17


```



```{r}

datos %>% filter(!is.na(fertilizar_analizar_mejor_comunidad)) %>%
  count(beneficiaria_si_no, fertilizar_analizar_mejor_comunidad) %>%       
  group_by(fertilizar_analizar_mejor_comunidad) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(fertilizar_analizar_mejor_comunidad, proporciones, fill= beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Fertilizar basado en un análisis de suelo es lo mejor para la comunidad")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + theme(axis.text.x = element_text(angle =35, hjust = 1)) + guides(fill=guide_legend(title="Beneficiario"))

```
Parece haber muy pocas personas en la categoría 'Completamente en desacuerdo' (10), por ende no parece importante analizar sus resultados. En las categorías de 'Completamente de acuerdo' y 'De acuerdo' parece haber una proporción mayor de personas que no son beneficiarias del programa (62.1% y 62.7%), posiblemente indicando que las personas que no son beneficiarias del programa tienden en mayor manera a considerar que la fertilización basada en análisis de suelos es lo mejor para el comunidad. En la categoría 'En desacuerdo' y la de 'Ni de acuerdo ni en desacuerdo' también se encuentra una mayor proporción de personas que no son beneficiarias del programa. 

Esto nos da información sobre creencias acerca de qué es bueno para la comunidad.

Un análisis más detallado.


```{r}


model13 <- multinom(fertilizar_analizar_mejor_comunidad ~ beneficiaria_si_no, data=datos)
summary (model13)

odds13 <- exp(coef(model13))
odds13

zvalues13 <- summary(model13)$coefficients / summary(model13)$standard.errors
p.values13 <- pnorm(abs(zvalues13), lower.tail=FALSE)*2
p.values13

```

Este análisis muestra que ser beneficiario hace menos probable ser indiferente sobre creer que fertilizar basado en un análisis de suelos es lo mejor para la comunidad (OR=0.33) comparado con no ser beneficiario. Las personas que son beneficiarias tienen una opinión sobre el impacto de fertilizar basado en el análisis de suelos sobre el bienestar de la comunidad.


### Cuántos productores fertilizan basados en análisis de suelos

### cuantos_fertilizan_analisis, género



```{r}

names(datos)[30] <- 'cuantos_fertilizan_analisis'
names(datos1)[30] <- 'cuantos_fertilizan_analisis'

datos <- datos %>% mutate( cuantos_fertilizan_analisis = as.factor(cuantos_fertilizan_analisis))
datos1 <- datos1 %>% mutate( cuantos_fertilizan_analisis = as.factor(cuantos_fertilizan_analisis))

class(datos$cuantos_fertilizan_analisis)
class(datos1$cuantos_fertilizan_analisis)
```


```{r}

datos1$cuantos_fertilizan_analisis <- recode_factor(datos1$cuantos_fertilizan_analisis, "MÃ¡s de la mitad"  = "Más de la mitad")

d18 <- sjt.xtab(datos1$cuantos_fertilizan_analisis, #rows
datos1$genero, show.summary = FALSE, show.row.prc = TRUE,  var.labels = c("¿Cuántos productores de la comunidad fertilizan basados en un análisis de suelos", "Género"), file="cuantos_fertilizan_analisis_genero.doc")

d18


```



```{r}
datos1$cuantos_fertilizan_analisis[datos1$cuantos_fertilizan_analisis == ""] <- "Sin datos"

datos1$cuantos_fertilizan_analisis <- recode_factor(datos1$cuantos_fertilizan_analisis, "NA" = "Sin datos")



datos1 %>% filter(!is.na(cuantos_fertilizan_analisis)) %>%
  count(genero, cuantos_fertilizan_analisis) %>%       
  group_by(cuantos_fertilizan_analisis) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(cuantos_fertilizan_analisis, proporciones, fill= genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Cuántos productores de la comunidad fertilizan basados en un análisis de suelos")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Género"))

```
Parece haber muy pocas personas en la categoría 'Todos' (8), por ende no parece importante analizar sus resultados. En la categoría que parece haber resultados más significativos es en la de 'Menos de la mitad': la mayoría de las personas de género masculino consideran que menos de la mitad de los productores usan el análisis de suelo para los procesos de fertilización. Esto puede considerarse un bloqueo de expectativa empírica asociada al género masculino. 

Esto hay que verlo en un análisis más detallado.


```{r}


model14 <- multinom(cuantos_fertilizan_analisis ~ genero, data=datos1)
summary (model14)

odds14 <- exp(coef(model14))
odds14

zvalues14 <- summary(model14)$coefficients / summary(model14)$standard.errors
p.values14 <- pnorm(abs(zvalues14), lower.tail=FALSE)*2
p.values14

```
Empero, los resultados no son significativos. 

### cuantos_fertilizan_analisis, beneficiarios


```{r}

datos$cuantos_fertilizan_analisis[datos$cuantos_fertilizan_analisis == ""] <- "Sin datos"

datos$cuantos_fertilizan_analisis <- recode_factor(datos$cuantos_fertilizan_analisis,"NA" = "Sin datos", "MÃ¡s de la mitad"  = "Más de la mitad")

datos$cuantos_fertilizan_analisis <- droplevels(datos$cuantos_fertilizan_analisis)

d19 <- sjt.xtab(datos$cuantos_fertilizan_analisis, #rows
datos$beneficiaria_si_no, show.summary = FALSE, show.row.prc = TRUE, var.labels = c("¿Cuántos productores usan el análisis de suelos para la fertilización?", "Beneficiario"), file="cuantos_fertilizan_analisis_beneficiario.doc")

d19


```



```{r}

datos %>% filter(!is.na(cuantos_fertilizan_analisis)) %>%
  count(beneficiaria_si_no, cuantos_fertilizan_analisis) %>%       
  group_by(cuantos_fertilizan_analisis) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(cuantos_fertilizan_analisis, proporciones, fill= beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Cuántos productores usan el análisis de suelos para la fertilización?")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) 

```
Esta pregunta es clave, son expectativas empíricas contrarias al cambio social. 
La gráfica indica que la mayoría de los no-beneficiarios parecen considerar que ningún productor usa el análisis de suelos para la fertilización, al igual que sucede en la categoría 'menos de la mitad'. Aunque lo mismo sucede en las categorías de expectativas empíricas positivas como 'La mitad', 'Más que la mitad' y 'Todos'. 

Un análisis más detallado.


```{r}


model15 <- multinom(cuantos_fertilizan_analisis ~ beneficiaria_si_no, data=datos)
summary (model15)

odds15 <- exp(coef(model15))
odds15

zvalues15 <- summary(model15)$coefficients / summary(model15)$standard.errors
p.values15 <- pnorm(abs(zvalues15), lower.tail=FALSE)*2
p.values15

```
Este modelo nos muestra un efecto de ser beneficiario del programa y una menor probabilidad de creer que ninguno (OR=0.4) o que menos de la mitad (or= 0.31)de los productores de la comunidad usan el análisis de suelos para sus actividades de fertilización. Esto implica que los beneficiarios podrían tener unas expectativas empíricas más positivas, alineadas a los objetivos del proyecto, lo que facilita la intervención para la generación-emergencia de una norma social.


### Cuántos productores creen que los productores deberían fertilizar basados en análisis de suelos

### cuantos_deberían_analisis, género



```{r}

names(datos)[31] <- 'cuantos_deberían_analisis'
names(datos1)[31] <- 'cuantos_deberían_analisis'

datos <- datos %>% mutate( cuantos_deberían_analisis = as.factor(cuantos_deberían_analisis))
datos1 <- datos1 %>% mutate( cuantos_deberían_analisis = as.factor(cuantos_deberían_analisis))

class(datos$cuantos_deberían_analisis)
class(datos1$cuantos_deberían_analisis)
```


```{r}

datos1$cuantos_deberían_analisis <- recode_factor(datos1$cuantos_deberían_analisis, "MÃ¡s de la mitad"  = "Más de la mitad")

d20 <- sjt.xtab(datos1$cuantos_deberían_analisis, #rows
datos1$genero, show.summary = FALSE, show.row.prc = TRUE,  var.labels = c("¿Cuántos productores creen que los productores deberían fertilizar basados en análisis de suelos?", "Género"), file="cuantos_deberían_analisis_genero.doc")

d20


```



```{r}


datos1 %>% filter(!is.na(cuantos_deberían_analisis)) %>%
  count(genero, cuantos_deberían_analisis) %>%       
  group_by(cuantos_deberían_analisis) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(cuantos_deberían_analisis, proporciones, fill= genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Cuántos productores creen que los productores deberían fertilizar basados en análisis de suelos?")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Género"))

```
Esto es importante ahora para expectativas normativas

En todas las categorías hay una mayor proporción de personas de género masculino. En todas las categorías de expectativas normativas positivas parece haber una mayor proporción de personas de género masculino: 'Todos'-63.3%, 'Más de la mitad'-71.6%, 'La mitad'-59%. Pero sucede lo mismo en las categorías que pueden considerarse negativas: 'Menos de la mitad'-69.4% y 'Ninguno'-59.3%.

Por ende se explora en un análisis más detallado.


```{r}


model16 <- multinom(cuantos_deberían_analisis ~ genero, data=datos1)
summary (model16)

odds16 <- exp(coef(model16))
odds16

zvalues16 <- summary(model16)$coefficients / summary(model16)$standard.errors
p.values16 <- pnorm(abs(zvalues16), lower.tail=FALSE)*2
p.values16

```
Empero no hay diferencias significativas.

### cuantos_deberían_analisis, beneficiarios


```{r}

datos$cuantos_deberían_analisis[datos$cuantos_deberían_analisis == ""] <- "Sin datos"

datos$cuantos_deberían_analisis <- recode_factor(datos$cuantos_deberían_analisis,"NA" = "Sin datos", "MÃ¡s de la mitad"  = "Más de la mitad")

datos$cuantos_deberían_analisis <- droplevels(datos$cuantos_deberían_analisis)

d21 <- sjt.xtab(datos$cuantos_deberían_analisis, #rows
datos$beneficiaria_si_no, show.summary = FALSE, show.row.prc = TRUE, var.labels = c("Cuántos productores creen que los productores deberían fertilizar basados en análisis de suelos", "Beneficiario"), file="cuantos_deberían_analisis_beneficiarios.doc")

d21


```



```{r}

datos %>% filter(!is.na(cuantos_deberían_analisis)) %>%
  count(beneficiaria_si_no, cuantos_deberían_analisis) %>%       
  group_by(cuantos_deberían_analisis) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(cuantos_deberían_analisis, proporciones, fill= beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Cuántos productores creen que los productores deberían fertilizar basados en análisis de suelos")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) 

```
Esta pregunta es clave, son expectativas empíricas contrarias al cambio social.

La gráfica indica que la mayoría de los no-beneficiarios parecen considerar que ningún productor debería usar el análisis de suelos para la fertilización, al igual que sucede en la categoría 'menos de la mitad'. Aunque lo mismo sucede en las categorías de expectativas normativas positivas como 'La mitad', 'Más que la mitad' y 'Todos'.

Un análisis más detallado.


```{r}


model17 <- multinom(cuantos_deberían_analisis ~ beneficiaria_si_no, data=datos)
summary (model17)

odds17 <- exp(coef(model17))
odds17

zvalues17 <- summary(model17)$coefficients / summary(model17)$standard.errors
p.values17 <- pnorm(abs(zvalues17), lower.tail=FALSE)*2
p.values17

```
Empero, las diferencias no son significativas.


### Aplicar materia orgánica al suelo es lo mejor para el ambiente

### organica_mejor_ambiente, genero



```{r}

names(datos)[36] <- 'organica_mejor_ambiente'
names(datos1)[36] <- 'organica_mejor_ambiente'

datos <- datos %>% mutate( organica_mejor_ambiente = as.factor(organica_mejor_ambiente))
datos1 <- datos1 %>% mutate( organica_mejor_ambiente = as.factor(organica_mejor_ambiente))

class(datos$organica_mejor_ambiente)
class(datos1$organica_mejor_ambiente)
```


```{r}

datos1$organica_mejor_ambiente <- recode_factor(datos1$organica_mejor_ambiente, "MÃ¡s de la mitad"  = "Más de la mitad")

d22 <- sjt.xtab(datos1$organica_mejor_ambiente, #rows
datos1$genero, show.summary = FALSE, show.row.prc = TRUE,  var.labels = c("Añadir materia orgánica a mi suelo es lo mejor para el ambiente", "Género"), file="organica_mejor_ambiente_genero.doc")

d22


```



```{r}


datos1 %>% filter(!is.na(organica_mejor_ambiente)) %>%
  count(genero, organica_mejor_ambiente) %>%       
  group_by(organica_mejor_ambiente) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(organica_mejor_ambiente, proporciones, fill= genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Añadir materia orgánica a mi suelo es lo mejor para el ambiente")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Género")) + theme(axis.text.x = element_text(angle =35, hjust = 1))

```
Esto es importante ahora para expectativas normativas

En las categorías negativas ('En desacuerdo' y 'Completamente en desacuerdo') y de indiferencia hay muy pocas personas (2, 1 y 3, respectivamente). Las respuestas se concentran en las categorías postivias 'De acuerdo' y 'Completamente de acuerdo' están la mayoría de las respuestas y en estas parece haber una mayor proporción de personas de género masculino (66.7% y 61.9%).

Por ende se explora en un análisis más detallado.


```{r}


model18 <- multinom(organica_mejor_ambiente ~ genero, data=datos1)
summary (model18)

odds18 <- exp(coef(model18))
odds18

zvalues18 <- summary(model18)$coefficients / summary(model18)$standard.errors
p.values18 <- pnorm(abs(zvalues18), lower.tail=FALSE)*2
p.values18

```
Empero, tales diferencias no parecen ser significativas.



### orgánica mejor ambiente, beneficiario


```{r}

datos$organica_mejor_ambiente[datos$organica_mejor_ambiente == ""] <- "Sin datos"

datos$organica_mejor_ambiente <- recode_factor(datos$organica_mejor_ambiente,"NA" = "Sin datos", "MÃ¡s de la mitad"  = "Más de la mitad")

datos$cuantos_deberían_analisis <- droplevels(datos$organica_mejor_ambiente)

d23 <- sjt.xtab(datos$organica_mejor_ambiente, #rows
datos$beneficiaria_si_no, show.summary = FALSE, show.row.prc = TRUE, var.labels = c("Añadir materia orgánica a mi suelo es lo mejor para el ambiente", "Beneficiario"), file="organica_mejor_ambiente_beneficiario.doc")

d23


```



```{r}

datos %>% filter(!is.na(organica_mejor_ambiente)) %>%
  count(beneficiaria_si_no, organica_mejor_ambiente) %>%       
  group_by(organica_mejor_ambiente) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(organica_mejor_ambiente, proporciones, fill= beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Añadir materia orgánica a mi suelo es lo mejor para el ambiente")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + theme(axis.text.x = element_text(angle =35, hjust = 1))


```
Esta pregunta es importante como medición de creencias fácticas.

En la mayoría de categorías, positivas, negativas y expresando indiferencia, hay una mayor proporción de personas beneficiarias (a excepción de la categoría 'Completamente en desacuerdo' en donde solo se cuenta con una persona). 

Un análisis más detallado.


```{r}


model19 <- multinom(organica_mejor_ambiente ~ beneficiaria_si_no, data=datos)
summary (model19)

odds19 <- exp(coef(model19))
odds19

zvalues19 <- summary(model19)$coefficients / summary(model19)$standard.errors
p.values19 <- pnorm(abs(zvalues19), lower.tail=FALSE)*2
p.values19

```

No hay diferencias significativas.



### Aplicar materia orgánica al suelo es lo mejor para mi bolsillo y el de mi familia

### organica_mejor_familia, genero



```{r}

names(datos)[37] <- 'organica_mejor_familia'
names(datos1)[37] <- 'organica_mejor_familia'

datos <- datos %>% mutate( organica_mejor_familia = as.factor(organica_mejor_familia))
datos1 <- datos1 %>% mutate( organica_mejor_familia = as.factor(organica_mejor_familia))

class(datos$organica_mejor_familia)
class(datos1$organica_mejor_familia)
```


```{r}

datos1$organica_mejor_familia <- recode_factor(datos1$organica_mejor_familia, "MÃ¡s de la mitad"  = "Más de la mitad")

d24 <- sjt.xtab(datos1$organica_mejor_familia, #rows
datos1$genero, show.summary = FALSE, show.row.prc = TRUE,  var.labels = c("Añadir materia orgánica a mi suelo es lo mejor para mi bolsillo y mi familia", "Género"), file="organica_mejor_familia_genero.doc")

d24


```



```{r}


datos1 %>% filter(!is.na(organica_mejor_familia)) %>%
  count(genero, organica_mejor_familia) %>%       
  group_by(organica_mejor_familia) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(organica_mejor_familia, proporciones, fill= genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Añadir materia orgánica a mi suelo es lo mejor para mi bolsillo y mi familia")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Género")) + theme(axis.text.x = element_text(angle =35, hjust = 1))

```
Esto es importante ahora para creencias fácticas de utilidad, para racionalidad práctica.

En las categorías negativas ('En desacuerdo' y 'Completamente en desacuerdo') y de indiferencia hay muy pocas personas (2, 2 y 4, respectivamente). Las respuestas se concentran en las categorías postivias 'De acuerdo' y 'Completamente de acuerdo' están la mayoría de las respuestas y en estas parece haber una mayor proporción de personas de género masculino (66.4% y 62.4%).

Por ende se explora en un análisis más detallado.


```{r}


model20 <- multinom(organica_mejor_familia ~ genero, data=datos1)
summary (model20)

odds20<- exp(coef(model20))
odds20

zvalues20 <- summary(model20)$coefficients / summary(model20)$standard.errors
p.values20 <- pnorm(abs(zvalues20), lower.tail=FALSE)*2
p.values20

```
No hay diferencias significativas.


### orgánica mejor familia, beneficiario


```{r}

datos$organica_mejor_familia[datos$organica_mejor_familia == ""] <- "Sin datos"

datos$organica_mejor_familia <- recode_factor(datos$organica_mejor_familia,"NA" = "Sin datos", "MÃ¡s de la mitad"  = "Más de la mitad")

datos$organica_mejor_familia <- droplevels(datos$organica_mejor_familia)

d25 <- sjt.xtab(datos$organica_mejor_familia, #rows
datos$beneficiaria_si_no, show.summary = FALSE, show.row.prc = TRUE, var.labels = c("Añadir materia orgánica a mi suelo es lo mejor para mi bolsillo y mi familia", "Beneficiario"), file="organica_mejor_familia_beneficiario.doc")

d25


```



```{r}

datos %>% filter(!is.na(organica_mejor_familia)) %>%
  count(beneficiaria_si_no, organica_mejor_familia) %>%       
  group_by(organica_mejor_familia) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(organica_mejor_familia, proporciones, fill= beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Añadir materia orgánica a mi suelo es lo mejor para mi bolsillo y mi familia")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + theme(axis.text.x = element_text(angle =35, hjust = 1))


```
Esta pregunta es importante como medición de creencias fácticas sobre utilidad, para racionalidad práctica.

En las categorías negativas hay muy pocas personas, en la indiferencia más con mayoría de no beneficiarios. En las positivas mayoría de no-beneficiarios. 

Un análisis más detallado.


```{r}


model21 <- multinom(organica_mejor_familia ~ beneficiaria_si_no, data=datos)
summary (model21)

odds21 <- exp(coef(model21))
odds21

zvalues21 <- summary(model21)$coefficients / summary(model21)$standard.errors
p.values21 <- pnorm(abs(zvalues21), lower.tail=FALSE)*2
p.values21

```

No hay diferencias significativas.



### Aplicar materia orgánica es lo mejor para el bienestar de mi comunidad

### organica_mejor_comunidad, genero


```{r}

names(datos)[38] <- 'organica_mejor_comunidad'
names(datos1)[38] <- 'organica_mejor_comunidad'

datos <- datos %>% mutate( organica_mejor_comunidad = as.factor(organica_mejor_comunidad))
datos1 <- datos1 %>% mutate( organica_mejor_comunidad = as.factor(organica_mejor_comunidad))

class(datos$organica_mejor_comunidad)
class(datos1$organica_mejor_comunidad)
```


```{r}

datos1$organica_mejor_comunidad <- recode_factor(datos1$organica_mejor_comunidad, "MÃ¡s de la mitad"  = "Más de la mitad")

d26 <- sjt.xtab(datos1$organica_mejor_comunidad, #rows
datos1$genero, show.summary = FALSE, show.row.prc = TRUE,  var.labels = c("Añadir materia orgánica a mi suelo es lo mejor para mi Comunidad", "Género"), file="organica_mejor_comunidad_genero.doc")

d26


```



```{r}


datos1 %>% filter(!is.na(organica_mejor_comunidad)) %>%
  count(genero, organica_mejor_comunidad) %>%       
  group_by(organica_mejor_comunidad) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(organica_mejor_comunidad, proporciones, fill= genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Añadir materia orgánica a mi suelo es lo mejor para mi comunidad")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Género")) + theme(axis.text.x = element_text(angle =35, hjust = 1))

```
Esto es importante ahora para creencias fácticas de utilidad, para racionalidad práctica.

En las categorías negativas ('En desacuerdo' y 'Completamente en desacuerdo') y de indiferencia hay muy pocas personas (1, 3 y 6 respectivamente). Las respuestas se concentran en las categorías postivias 'De acuerdo' y 'Completamente de acuerdo' están la mayoría de las respuestas y en estas parece haber una mayor proporción de personas de género masculino (67.3% y 62.2%).

Por ende se explora en un análisis más detallado.


```{r}


model22 <- multinom(organica_mejor_comunidad ~ genero, data=datos1)
summary (model22)

odds22<- exp(coef(model22))
odds22

zvalues22 <- summary(model22)$coefficients / summary(model22)$standard.errors
p.values22 <- pnorm(abs(zvalues22), lower.tail=FALSE)*2
p.values22

```

No hay diferencias significativas.

### orgánica mejor comunidad, beneficiario


```{r}

datos$organica_mejor_comunidad[datos$organica_mejor_comunidad == ""] <- "Sin datos"

datos$organica_mejor_comunidad <- recode_factor(datos$organica_mejor_comunidad,"NA" = "Sin datos", "MÃ¡s de la mitad"  = "Más de la mitad")

datos$organica_mejor_comunidad <- droplevels(datos$organica_mejor_comunidad)

d27 <- sjt.xtab(datos$organica_mejor_comunidad, #rows
datos$beneficiaria_si_no, show.summary = FALSE, show.row.prc = TRUE, var.labels = c("Añadir materia orgánica a mi suelo es lo mejor para mi comunidad", "Beneficiario"), file="organica_mejor_comunidad_beneficiario.doc")

d27


```



```{r}

datos %>% filter(!is.na(organica_mejor_comunidad)) %>%
  count(beneficiaria_si_no, organica_mejor_comunidad) %>%       
  group_by(organica_mejor_comunidad) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(organica_mejor_comunidad, proporciones, fill= beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Añadir materia orgánica a mi suelo es lo mejor para mi comunidad")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + theme(axis.text.x = element_text(angle =35, hjust = 1))


```
Esta pregunta es importante como medición de creencias fácticas sobre utilidad, para racionalidad práctica.

En las categorías negativas hay muy pocas personas, en la indiferencia más con mayoría de no beneficiarios. En las positivas mayoría de no-beneficiarios. 

Un análisis más detallado.


```{r}


model23 <- multinom(organica_mejor_comunidad ~ beneficiaria_si_no, data=datos)
summary (model23)

odds23 <- exp(coef(model23))
odds23

zvalues23 <- summary(model23)$coefficients / summary(model23)$standard.errors
p.values23 <- pnorm(abs(zvalues23), lower.tail=FALSE)*2
p.values23

```

No hay diferencias significativas

### cuántos productores de la comunidad aplican materia orgánica a sus suelos
### cuantos_productores_organica, género

```{r}

names(datos)[39] <- 'cuantos_productores_organica'
names(datos1)[39] <- 'cuantos_productores_organica'

datos <- datos %>% mutate( cuantos_productores_organica = as.factor(cuantos_productores_organica))
datos1 <- datos1 %>% mutate( cuantos_productores_organica = as.factor(cuantos_productores_organica))

class(datos$cuantos_productores_organica)
class(datos1$cuantos_productores_organica)
```


```{r}

datos1$cuantos_productores_organica[datos1$cuantos_productores_organica == ""] <- "Sin datos"

datos1$cuantos_productores_organica <- recode_factor(datos1$cuantos_productores_organica, "NA" = "Sin datos")

datos1$cuantos_productores_organica <- droplevels(datos1$cuantos_productores_organica)


d28 <- sjt.xtab(datos1$cuantos_productores_organica, #rows
datos1$genero, show.summary = FALSE, show.row.prc = TRUE,  var.labels = c("Cuántos productores de la comunidad aplican materia orgánica a sus suelos", "Género"), file="cuantos_productores_organica_genero.doc")

d28


```



```{r}


datos1 %>% filter(!is.na(cuantos_productores_organica)) %>%
  count(genero, cuantos_productores_organica) %>%       
  group_by(cuantos_productores_organica) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(cuantos_productores_organica, proporciones, fill= genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Cuántos productores de mi comunidad aplican materia orgánica a sus suelos")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Género")) + theme(axis.text.x = element_text(angle =35, hjust = 1))

```
Esto es importante ahora para expectativas empíricas.

En todas las categorías, positivas y negativas, mayor parte de personas de género masculino.



Por ende se explora en un análisis más detallado.


```{r}


model24 <- multinom(cuantos_productores_organica ~ genero, data=datos1)
summary (model24)

odds24<- exp(coef(model24))
odds24

zvalues24 <- summary(model24)$coefficients / summary(model24)$standard.errors
p.values24 <- pnorm(abs(zvalues24), lower.tail=FALSE)*2
p.values24

```

No hay diferencias significativas.


### orgánica mejor comunidad, beneficiario


```{r}

datos$cuantos_productores_organica[datos$cuantos_productores_organica == ""] <- "Sin datos"

datos$cuantos_productores_organica <- recode_factor(datos$cuantos_productores_organica,"NA" = "Sin datos", "MÃ¡s de la mitad"  = "Más de la mitad")

datos$cuantos_productores_organica <- droplevels(datos$cuantos_productores_organica)

d29 <- sjt.xtab(datos$cuantos_productores_organica, #rows
datos$beneficiaria_si_no, show.summary = FALSE, show.row.prc = TRUE, var.labels = c("Cuántos productores de mi comunidad aplican materia orgánica a sus suelos", "Beneficiario"), file="cuantos_productores_organica_beneficiario.doc")

d29


```



```{r}

datos %>% filter(!is.na(cuantos_productores_organica)) %>%
  count(beneficiaria_si_no, cuantos_productores_organica) %>%       
  group_by(cuantos_productores_organica) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(cuantos_productores_organica, proporciones, fill= beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Cuántos productores de mi comunidad aplican materia orgánica a sus suelos")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + theme(axis.text.x = element_text(angle =35, hjust = 1))


```
Esta pregunta es importante como medición de creencias fácticas sobre utilidad, para racionalidad práctica.

En todas, positivas y negativas, mayoría no-beneficiarios.

Un análisis más detallado.


```{r}


model25 <- multinom(cuantos_productores_organica ~ beneficiaria_si_no, data=datos)
summary (model25)

odds25 <- exp(coef(model25))
odds25

zvalues25 <- summary(model25)$coefficients / summary(model25)$standard.errors
p.values25 <- pnorm(abs(zvalues25), lower.tail=FALSE)*2
p.values25

```

No hay diferencias significativas.

### ¿Cuántos productores de la comunidad consideran que los productores deberían aplicar materia orgánica a sus suelos?
### cuantos_deberian_organica

```{r}

names(datos)[39] <- 'cuantos_deberian_organica'
names(datos1)[39] <- 'cuantos_deberian_organica'

datos <- datos %>% mutate( cuantos_deberian_organica = as.factor(cuantos_deberian_organica))
datos1 <- datos1 %>% mutate( cuantos_deberian_organica = as.factor(cuantos_deberian_organica))

class(datos$cuantos_deberian_organica)
class(datos1$cuantos_deberian_organica)
```


```{r}

datos1$cuantos_deberian_organica[datos1$cuantos_deberian_organica == ""] <- "Sin datos"

datos1$cuantos_deberian_organica <- recode_factor(datos1$cuantos_deberian_organica, "NA" = "Sin datos", "MÃ¡s de la mitad"  = "Más de la mitad")

datos1$cuantos_deberian_organica <- droplevels(datos1$cuantos_deberian_organica)


d30 <- sjt.xtab(datos1$cuantos_deberian_organica, #rows
datos1$genero, show.summary = FALSE, show.row.prc = TRUE,  var.labels = c("Cuántos productores de la comunidad consideran que los productores deberían aplicar materia orgánica a sus suelos", "Género"), file="cuantos_deberian_organica_genero.doc")

d30


```



```{r}


datos1 %>% filter(!is.na(cuantos_deberian_organica)) %>%
  count(genero, cuantos_deberian_organica) %>%       
  group_by(cuantos_deberian_organica) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(cuantos_deberian_organica, proporciones, fill= genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Cuántos productores de la comunidad consideran que los productoresn \n deberían aplicar materia orgánica a sus suelos")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Género")) + theme(axis.text.x = element_text(angle =35, hjust = 1))

```
Esto es importante ahora para expectativas normativas.

En todas las categorías, positivas y negativas, mayor parte de personas de género masculino. Expresa un ideal importante para la intervención.



Por ende se explora en un análisis más detallado.


```{r}


model26 <- multinom(cuantos_deberian_organica ~ genero, data=datos1)
summary (model26)

odds26<- exp(coef(model26))
odds26

zvalues26 <- summary(model26)$coefficients / summary(model26)$standard.errors
p.values26 <- pnorm(abs(zvalues26), lower.tail=FALSE)*2
p.values26

```
No hay diferencias significativas.


### orgánica mejor comunidad, beneficiario


```{r}

datos$cuantos_deberian_organica[datos$cuantos_deberian_organica == ""] <- "Sin datos"

datos$cuantos_deberian_organica <- recode_factor(datos$cuantos_deberian_organica,"NA" = "Sin datos", "MÃ¡s de la mitad"  = "Más de la mitad")

datos$cuantos_deberian_organica <- droplevels(datos$cuantos_deberian_organica)

d31 <- sjt.xtab(datos$cuantos_deberian_organica, #rows
datos$beneficiaria_si_no, show.summary = FALSE, show.row.prc = TRUE, var.labels = c("Cuántos productores de la comunidad consideran que los productores deberían aplicar materia orgánica a sus suelos", "Beneficiario"), file="cuantos_deberian_organica_beneficiario.doc")

d31


```



```{r}

datos %>% filter(!is.na(cuantos_deberian_organica)) %>%
  count(beneficiaria_si_no, cuantos_deberian_organica) %>%       
  group_by(cuantos_deberian_organica) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(cuantos_deberian_organica, proporciones, fill= beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Cuántos productores de mi comunidad aplican materia orgánica a sus suelos")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + theme(axis.text.x = element_text(angle =35, hjust = 1))


```
Esta pregunta es importante como medición de expectativas empíricas, sobre utilidad, para racionalidad práctica.

En todas, positivas y negativas, mayoría no-beneficiarios.

Un análisis más detallado.


```{r}


model27 <- multinom(cuantos_deberian_organica ~ beneficiaria_si_no, data=datos)
summary (model27)
    
odds27 <- exp(coef(model27))
odds27

zvalues27 <- summary(model27)$coefficients / summary(model27)$standard.errors
p.values27 <- pnorm(abs(zvalues27), lower.tail=FALSE)*2
p.values27

```
No hay diferencias significativas.


## compost

### General

```{r}

names(datos)[33] <- 'usa_compost'
names(datos1)[33] <- 'usa_compost'

datos <- datos %>% mutate( usa_compost = as.factor(usa_compost))
datos1 <- datos1 %>% mutate( usa_compost = as.factor(usa_compost))

class(datos$usa_compost)
class(datos1$usa_compost)
```

```{r}
datos1$usa_compost[datos1$usa_compost == ""] <- "Sin datos"

datos1$usa_compost <- recode_factor(datos1$usa_compost, "NA" = "Sin datos")



datos1 %>% filter(!is.na(usa_compost)) %>%
  count(genero, usa_compost) %>%       
  group_by(usa_compost) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(usa_compost, proporciones, fill=genero) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Ha aplicado compost algunas vez a su suelos?")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Genero")) + theme(axis.text.x = element_text(angle =35, hjust = 1)) + scale_fill_discrete(labels = c("Femenino", "Masculino")) +  scale_x_discrete(labels = c("No", "Sí"))
```

```{r}
model42 <- multinom(usa_compost ~ beneficiaria_si_no, data=datos)
summary (model42)

odds42 <- exp(coef(model42))
odds42

zvalues42 <- summary(model42)$coefficients / summary(model42)$standard.errors
p.values42 <- pnorm(abs(zvalues42), lower.tail=FALSE)*2
p.values42
```

```{r}
model43 <- multinom(usa_compost ~ genero, data=datos1)
summary (model43)

odds43 <- exp(coef(model43))
odds43

zvalues43 <- summary(model43)$coefficients / summary(model43)$standard.errors
p.values43 <- pnorm(abs(zvalues43), lower.tail=FALSE)*2
p.values43
```

### Creencias individuales

```{r}

names(datos)[37] <- 'compost_yo'
names(datos1)[37] <- 'compost_yo'

datos <- datos %>% mutate( compost_yo = as.factor(compost_yo))
datos1 <- datos1 %>% mutate( compost_yo = as.factor(compost_yo))

class(datos$compost_yo)
class(datos1$compost_yo)
```

```{r}
datos$valioso_analisis_suelo[datos$valioso_analisis_suelo == ""] <- "Sin datos"

datos$valioso_analisis_suelo <- recode_factor(datos$valioso_analisis_suelo, "NA" = "Sin datos")



datos %>% filter(!is.na(valioso_analisis_suelo)) %>%
  count(beneficiaria_si_no, valioso_analisis_suelo) %>%       
  group_by(valioso_analisis_suelo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(valioso_analisis_suelo, proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Vale la pena hacer un análisis de suelo al menos cada 3 años?")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + theme(axis.text.x = element_text(angle =35, hjust = 1))
```

```{r}
model44 <- multinom(compost_yo ~ beneficiaria_si_no, data=datos)
summary (model44)

odds44 <- exp(coef(model44))
odds44

zvalues44 <- summary(model44)$coefficients / summary(model44)$standard.errors
p.values44 <- pnorm(abs(zvalues44), lower.tail=FALSE)*2
p.values44
```
```{r}
model45 <- multinom(compost_yo ~ genero, data=datos1)
summary (model45)

odds45 <- exp(coef(model45))
odds45

zvalues45 <- summary(model45)$coefficients / summary(model45)$standard.errors
p.values45 <- pnorm(abs(zvalues45), lower.tail=FALSE)*2
p.values45
```
```{r}

names(datos)[38] <- 'compost_comunidad'
names(datos1)[38] <- 'compost_comunidad'

datos <- datos %>% mutate( compost_comunidad = as.factor(compost_comunidad))
datos1 <- datos1 %>% mutate( compost_comunidad = as.factor(compost_comunidad))

class(datos$compost_comunidad)
class(datos1$compost_comunidad)
```
```{r}
model46 <- multinom(compost_comunidad ~ genero, data=datos1)
summary (model46)

odds46 <- exp(coef(model46))
odds46

zvalues46 <- summary(model46)$coefficients / summary(model46)$standard.errors
p.values46 <- pnorm(abs(zvalues46), lower.tail=FALSE)*2
p.values46
```
```{r}
model47 <- multinom(compost_comunidad ~ beneficiaria_si_no, data=datos)
summary (model47)

odds47 <- exp(coef(model47))
odds47

zvalues47 <- summary(model47)$coefficients / summary(model47)$standard.errors
p.values47 <- pnorm(abs(zvalues47), lower.tail=FALSE)*2
p.values47
```


```{r}
datos$valioso_analisis_suelo[datos$valioso_analisis_suelo == ""] <- "Sin datos"

datos$valioso_analisis_suelo <- recode_factor(datos$valioso_analisis_suelo, "NA" = "Sin datos")



datos %>% filter(!is.na(valioso_analisis_suelo)) %>%
  count(beneficiaria_si_no, valioso_analisis_suelo) %>%       
  group_by(valioso_analisis_suelo) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(valioso_analisis_suelo, proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Vale la pena hacer un análisis de suelo al menos cada 3 años?")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + theme(axis.text.x = element_text(angle =35, hjust = 1))
```

```{r}
model7 <- multinom(valioso_analisis_suelo ~ beneficiaria_si_no, data=datos)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7
```


```{r}

names(datos)[36] <- 'compost_ambiente'
names(datos1)[36] <- 'compost_ambiente'

datos <- datos %>% mutate( compost_ambiente = as.factor(compost_ambiente))
datos1 <- datos1 %>% mutate( compost_ambiente = as.factor(compost_ambiente))

class(datos$compost_ambiente)
class(datos1$compost_ambiente)
```



```{r}
model48 <- multinom(compost_ambiente ~ genero, data=datos1)
summary (model48)

odds48 <- exp(coef(model48))
odds48

zvalues48 <- summary(model48)$coefficients / summary(model48)$standard.errors
p.values48 <- pnorm(abs(zvalues48), lower.tail=FALSE)*2
p.values48
```
```{r}
model49 <- multinom(compost_ambiente ~ beneficiaria_si_no, data=datos)
summary (model49)

odds49 <- exp(coef(model49))
odds49

zvalues49 <- summary(model49)$coefficients / summary(model49)$standard.errors
p.values49 <- pnorm(abs(zvalues49), lower.tail=FALSE)*2
p.values49
```

### Expectativas


```{r}

names(datos)[39] <- 'compost_empirica'
names(datos1)[39] <- 'compost_empirica'

datos <- datos %>% mutate( compost_empirica = as.factor(compost_empirica))
datos1 <- datos1 %>% mutate( compost_empirica = as.factor(compost_empirica))

class(datos$compost_empirica)
class(datos1$compost_empirica)
```
```{r}
model51 <- multinom(compost_empirica ~ genero, data=datos1)
summary (model51)

odds51 <- exp(coef(model51))
odds51

zvalues51 <- summary(model51)$coefficients / summary(model51)$standard.errors
p.values51 <- pnorm(abs(zvalues51), lower.tail=FALSE)*2
p.values51
```
```{r}

names(datos)[40] <- 'compost_normativa'
names(datos1)[40] <- 'compost_normativa'

datos <- datos %>% mutate( compost_normativa = as.factor(compost_normativa))
datos1 <- datos1 %>% mutate( compost_normativa = as.factor(compost_normativa))

class(datos$compost_normativa)
class(datos1$compost_normativa)
```

```{r}
model52 <- multinom(compost_normativa ~ genero, data=datos1)
summary (model52)

odds52 <- exp(coef(model52))
odds52

zvalues52 <- summary(model52)$coefficients / summary(model52)$standard.errors
p.values52 <- pnorm(abs(zvalues52), lower.tail=FALSE)*2
p.values52
```
```{r}
model53 <- multinom(compost_normativa ~ beneficiaria_si_no, data=datos)
summary (model53)

odds53 <- exp(coef(model53))
odds53

zvalues53 <- summary(model53)$coefficients / summary(model53)$standard.errors
p.values53 <- pnorm(abs(zvalues53), lower.tail=FALSE)*2
p.values53
```

## datos agroclimáticos

### General

```{r}

names(datos)[91] <- 'agroclimaticos'
names(datos1)[91] <- 'agroclimaticos'

datos <- datos %>% mutate( agroclimaticos = as.factor(agroclimaticos))
datos1 <- datos1 %>% mutate( agroclimaticos = as.factor(agroclimaticos))

class(datos$agroclimaticos)
class(datos1$agroclimaticos)
```

```{r}
model54 <- multinom(agroclimaticos ~ genero, data=datos1)
summary (model54)

odds54 <- exp(coef(model54))
odds54

zvalues54 <- summary(model54)$coefficients / summary(model54)$standard.errors
p.values54 <- pnorm(abs(zvalues54), lower.tail=FALSE)*2
p.values54
```

```{r}
model55 <- multinom(agroclimaticos ~ beneficiaria_si_no, data=datos)
summary (model55)

odds55 <- exp(coef(model55))
odds55

zvalues55 <- summary(model55)$coefficients / summary(model55)$standard.errors
p.values55 <- pnorm(abs(zvalues55), lower.tail=FALSE)*2
p.values55
```
### Creencias individuales

```{r}

names(datos)[93] <- 'agroclimaticos_yo'
names(datos1)[93] <- 'agroclimaticos_yo'

datos <- datos %>% mutate( agroclimaticos_yo = as.factor(agroclimaticos_yo))
datos1 <- datos1 %>% mutate( agroclimaticos_yo = as.factor(agroclimaticos_yo))

class(datos$agroclimaticos_yo)
class(datos1$agroclimaticos_yo)
```
```{r}
model56 <- multinom(agroclimaticos_yo ~ beneficiaria_si_no, data=datos)
summary (model56)

odds56 <- exp(coef(model56))
odds56

zvalues56 <- summary(model56)$coefficients / summary(model56)$standard.errors
p.values56 <- pnorm(abs(zvalues56), lower.tail=FALSE)*2
p.values56
```
```{r}
datos$agroclimaticos_yo [datos$agroclimaticos_yo  == ""] <- "Sin datos"

datos$agroclimaticos_yo  <- recode_factor(datos$agroclimaticos_yo , "NA" = "Sin datos")



datos %>% filter(!is.na(agroclimaticos_yo )) %>%
  count(beneficiaria_si_no, agroclimaticos_yo ) %>%       
  group_by(agroclimaticos_yo ) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(agroclimaticos_yo , proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Recolectar y usar datos de lluvia y temperatura para ajustar el riego es lo mejor para mí y mi familia")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + theme(axis.text.x = element_text(angle =35, hjust = 1)) 
```

```{r}
model57 <- multinom(agroclimaticos_yo ~ genero, data=datos1)
summary (model57)

odds57 <- exp(coef(model57))
odds57

zvalues57 <- summary(model57)$coefficients / summary(model57)$standard.errors
p.values57 <- pnorm(abs(zvalues57), lower.tail=FALSE)*2
p.values57
```

```{r}

names(datos)[94] <- 'agroclimaticos_comunidad'
names(datos1)[94] <- 'agroclimaticos_comunidad'

datos <- datos %>% mutate( agroclimaticos_comunidad = as.factor(agroclimaticos_comunidad))
datos1 <- datos1 %>% mutate( agroclimaticos_comunidad = as.factor(agroclimaticos_comunidad))

class(datos$agroclimaticos_comunidad)
class(datos1$agroclimaticos_comunidad)
```
```{r}
model58 <- multinom(agroclimaticos_comunidad ~ genero, data=datos1)
summary (model58)

odds58 <- exp(coef(model58))
odds58

zvalues58 <- summary(model58)$coefficients / summary(model58)$standard.errors
p.values58 <- pnorm(abs(zvalues58), lower.tail=FALSE)*2
p.values58
```

```{r}
model59 <- multinom(agroclimaticos_comunidad ~ beneficiaria_si_no, data=datos)
summary (model59)

odds59 <- exp(coef(model59))
odds59

zvalues59 <- summary(model59)$coefficients / summary(model59)$standard.errors
p.values59 <- pnorm(abs(zvalues59), lower.tail=FALSE)*2
p.values59
```

```{r}
datos$agroclimaticos_comunidad [datos$agroclimaticos_comunidad  == ""] <- "Sin datos"

datos$agroclimaticos_comunidad  <- recode_factor(datos$agroclimaticos_comunidad , "NA" = "Sin datos")



datos %>% filter(!is.na(agroclimaticos_comunidad )) %>%
  count(beneficiaria_si_no, agroclimaticos_comunidad ) %>%       
  group_by(agroclimaticos_comunidad ) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(agroclimaticos_comunidad , proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Recolectar y usar datos de lluvia y temperatura para ajustar el riego es lo mejor para mi comunidad")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + theme(axis.text.x = element_text(angle =35, hjust = 1)) 
```

```{r}

names(datos)[92] <- 'agroclimaticos_ambiente'
names(datos1)[92] <- 'agroclimaticos_ambiente'

datos <- datos %>% mutate( agroclimaticos_ambiente = as.factor(agroclimaticos_ambiente))
datos1 <- datos1 %>% mutate( agroclimaticos_ambiente = as.factor(agroclimaticos_ambiente))

class(datos$agroclimaticos_ambiente)
class(datos1$agroclimaticos_ambiente)
```
```{r}
model60 <- multinom(agroclimaticos_ambiente ~ beneficiaria_si_no, data=datos)
summary (model60)

odds60 <- exp(coef(model60))
odds60

zvalues60 <- summary(model60)$coefficients / summary(model60)$standard.errors
p.values60 <- pnorm(abs(zvalues60), lower.tail=FALSE)*2
p.values60
```
```{r}
datos$agroclimaticos_ambiente [datos$agroclimaticos_ambiente  == ""] <- "Sin datos"

datos$agroclimaticos_ambiente  <- recode_factor(datos$agroclimaticos_ambiente , "NA" = "Sin datos")



datos %>% filter(!is.na(agroclimaticos_ambiente )) %>%
  count(beneficiaria_si_no, agroclimaticos_ambiente ) %>%       
  group_by(agroclimaticos_ambiente ) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(agroclimaticos_ambiente , proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("Recolectar y usar datos de lluvia y temperatura para ajustar el riego es lo mejor para el ambiente")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + theme(axis.text.x = element_text(angle =35, hjust = 1)) 
```
### Expectativas

```{r}

names(datos)[95] <- 'agroclimaticos_descriptiva'
names(datos1)[95] <- 'agroclimaticos_descriptiva'

datos <- datos %>% mutate( agroclimaticos_descriptiva= as.factor(agroclimaticos_descriptiva))
datos1 <- datos1 %>% mutate( agroclimaticos_descriptiva = as.factor(agroclimaticos_descriptiva))

class(datos$agroclimaticos_descriptiva)
class(datos1$agroclimaticos_descriptiva)
```
```{r}
model61 <- multinom(agroclimaticos_descriptiva ~ beneficiaria_si_no, data=datos)
summary (model61)

odds61 <- exp(coef(model61))
odds61

zvalues61 <- summary(model61)$coefficients / summary(model61)$standard.errors
p.values61 <- pnorm(abs(zvalues61), lower.tail=FALSE)*2
p.values61
```

```{r}

names(datos)[96] <- 'agroclimaticos_normativa'
names(datos1)[96] <- 'agroclimaticos_normativa'

datos <- datos %>% mutate( agroclimaticos_normativa= as.factor(agroclimaticos_normativa))
datos1 <- datos1 %>% mutate( agroclimaticos_normativa = as.factor(agroclimaticos_normativa))

class(datos$agroclimaticos_normativa)
class(datos1$agroclimaticos_normativa)
```

aa

```{r}
model62 <- multinom(agroclimaticos_normativa ~ beneficiaria_si_no, data=datos)
summary (model62)

odds62 <- exp(coef(model62))
odds62

zvalues62 <- summary(model62)$coefficients / summary(model62)$standard.errors
p.values62 <- pnorm(abs(zvalues62), lower.tail=FALSE)*2
p.values62
```

```{r}
datos$agroclimaticos_normativa[datos1$agroclimaticos_normativa == ""] <- "Sin datos"

datos$agroclimaticos_normativa <- recode_factor(datos$agroclimaticos_normativa, "NA" = "Sin datos")



datos %>% filter(!is.na(agroclimaticos_normativa)) %>%
  count(beneficiaria_si_no, agroclimaticos_normativa) %>%       
  group_by(agroclimaticos_normativa) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(agroclimaticos_normativa, proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Cuántos productores de la comunidad recolectan y usan \n datos de lluvia y temperatura para ajustar el riego?")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + theme(axis.text.x = element_text(angle =35, hjust = 1))  +  scale_x_discrete(labels = c("La mitad", "Más de la mitad", "Menos de la mitad", "Ninguno", "Todos"))
```

```{r}

names(datos)[95] <- 'agroclimaticos_descriptiva'
names(datos1)[95] <- 'agroclimaticos_descriptiva'

datos <- datos %>% mutate( agroclimaticos_descriptiva= as.factor(agroclimaticos_descriptiva))
datos1 <- datos1 %>% mutate( agroclimaticos_descriptiva = as.factor(agroclimaticos_descriptiva))

class(datos$agroclimaticos_descriptiva)
class(datos1$agroclimaticos_descriptiva)
```

## Cobertura y biodiversidad

```{r}

names(datos)[71] <- 'cercasvivas_descriptiva'
names(datos1)[71] <- 'cercasvivas_descriptiva'

datos <- datos %>% mutate( cercasvivas_descriptiva = as.factor(cercasvivas_descriptiva))
datos1 <- datos1 %>% mutate( cercasvivas_descriptiva = as.factor(cercasvivas_descriptiva))

class(datos$cercasvivas_descriptiva)
class(datos1$cercasvivas_descriptiva)
```
```{r}


model70 <- multinom(cercasvivas_descriptiva ~ beneficiaria_si_no, data=datos)
summary (model70)

odds70 <- exp(coef(model70))
odds70

zvalues70 <- summary(model70)$coefficients / summary(model70)$standard.errors
p.values70 <- pnorm(abs(zvalues70), lower.tail=FALSE)*2
p.values70

```
```{r}


model71 <- multinom(cercasvivas_descriptiva ~ genero, data=datos1)
summary (model71)

odds71 <- exp(coef(model71))
odds71

zvalues71 <- summary(model71)$coefficients / summary(model71)$standard.errors
p.values71 <- pnorm(abs(zvalues71), lower.tail=FALSE)*2
p.values71

```

```{r}

names(datos)[72] <- 'cercasvivas_normativa'
names(datos1)[72] <- 'cercasvivas_normativa'

datos <- datos %>% mutate( cercasvivas_normativa = as.factor(cercasvivas_normativa))
datos1 <- datos1 %>% mutate( cercasvivas_normativa = as.factor(cercasvivas_normativa))

class(datos$cercasvivas_normativa)
class(datos1$cercasvivas_normativa)
```
```{r}


model70 <- multinom(cercasvivas_normativa ~ beneficiaria_si_no, data=datos)
summary (model70)

odds70 <- exp(coef(model70))
odds70

zvalues70 <- summary(model70)$coefficients / summary(model70)$standard.errors
p.values70 <- pnorm(abs(zvalues70), lower.tail=FALSE)*2
p.values70

```
```{r}


model71 <- multinom(cercasvivas_normativa ~ genero, data=datos1)
summary (model71)

odds71 <- exp(coef(model71))
odds71

zvalues71 <- summary(model71)$coefficients / summary(model71)$standard.errors
p.values71 <- pnorm(abs(zvalues71), lower.tail=FALSE)*2
p.values71

```

```{r}

names(datos)[46] <- 'quemas'
names(datos1)[46] <- 'quemas'

datos <- datos %>% mutate( quemas = as.factor(quemas))
datos1 <- datos1 %>% mutate( quemas = as.factor(quemas))

class(datos$quemas)
class(datos1$quemas)
```


```{r}


model7 <- multinom(quemas ~ beneficiaria_si_no, data=datos)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```

```{r}


model7 <- multinom(quemas ~ genero, data=datos1)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```


```{r}

names(datos)[47] <- 'quemas_descriptivo'
names(datos1)[47] <- 'quemas_descriptivo'

datos <- datos %>% mutate( quemas_descriptivo = as.factor(quemas_descriptivo))
datos1 <- datos1 %>% mutate( quemas_descriptivo = as.factor(quemas_descriptivo))

class(datos$quemas_descriptivo)
class(datos1$quemas_descriptivo)
```

```{r}


model7 <- multinom(quemas_descriptivo ~ genero, data=datos1)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```
```{r}


model7 <- multinom(quemas_descriptivo ~ beneficiaria_si_no, data=datos)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```

```{r}

names(datos)[48] <- 'quemas_normativo'
names(datos1)[48] <- 'quemas_normativo'

datos <- datos %>% mutate( quemas_normativo = as.factor(quemas_normativo))
datos1 <- datos1 %>% mutate( quemas_normativo = as.factor(quemas_normativo))

class(datos$quemas_normativo)
class(datos1$quemas_normativo)
```

```{r}


model7 <- multinom(quemas_normativo ~ beneficiaria_si_no, data=datos)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```

```{r}


model7 <- multinom(quemas_normativo ~ genero, data=datos1)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```
```{r}

names(datos)[79] <- 'especiesnativas'
names(datos1)[79] <- 'especiesnativas'

datos <- datos %>% mutate( especiesnativas = as.factor(especiesnativas))
datos1 <- datos1 %>% mutate( especiesnativas = as.factor(especiesnativas))

class(datos$especiesnativas)
class(datos1$especiesnativas)
```
```{r}


model7 <- multinom(especiesnativas ~ genero, data=datos1)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```

```{r}


model7 <- multinom(especiesnativas ~ beneficiaria_si_no, data=datos)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```

```{r}
datos$especiesnativas[datos1$especiesnativas == ""] <- "Sin datos"

datos$especiesnativas <- recode_factor(datos$especiesnativas, "NA" = "Sin datos")



datos %>% filter(!is.na(especiesnativas)) %>%
  count(beneficiaria_si_no, especiesnativas) %>%       
  group_by(especiesnativas) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(especiesnativas, proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Planta especies nativas en las rondas y nacimientos de fuentes de agua")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + theme(axis.text.x = element_text(angle =35, hjust = 1))  +  scale_x_discrete(labels = c("No", "Sí"))
```


```{r}

names(datos)[82] <- 'especiesnativas_empirica'
names(datos1)[82] <- 'especiesnativas_empirica'

datos <- datos %>% mutate( especiesnativas_empirica = as.factor(especiesnativas_empirica))
datos1 <- datos1 %>% mutate( especiesnativas_empirica = as.factor(especiesnativas_empirica))

class(datos$especiesnativas_empirica)
class(datos1$especiesnativas_empirica)
```

```{r}


model7 <- multinom(especiesnativas_empirica ~ beneficiaria_si_no, data=datos)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```
```{r}
datos$especiesnativas_empirica[datos$especiesnativas_empirica == ""] <- "Sin datos"

datos$especiesnativas_empirica <- recode_factor(datos$especiesnativas_empirica, "NA" = "Sin datos")



datos %>% filter(!is.na(especiesnativas_empirica)) %>%
  count(beneficiaria_si_no, especiesnativas_empirica) %>%       
  group_by(especiesnativas_empirica) %>%
  mutate(proporciones= prop.table(n) * 100) %>%
  
  ggplot() + 
    aes(especiesnativas_empirica, proporciones, fill=beneficiaria_si_no) +
    geom_bar(stat="identity") +
    ylab("") + xlab("¿Cuántos productores plantan especies nativas en las rondas y nacimientos de fuentes de agua")  + 
     geom_text(aes(label=paste0(sprintf("%1.1f", proporciones),"%")), position=position_stack(vjust=0.5)) + guides(fill=guide_legend(title="Beneficiario")) + theme(axis.text.x = element_text(angle =35, hjust = 1))  
```

```{r}


model7 <- multinom(especiesnativas_empirica ~ genero, data=datos1)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```
```{r}

names(datos)[83] <- 'especiesnativas_normativa'
names(datos1)[83] <- 'especiesnativas_normativa'

datos <- datos %>% mutate( especiesnativas_normativa = as.factor(especiesnativas_normativa))
datos1 <- datos1 %>% mutate( especiesnativas_normativa = as.factor(especiesnativas_normativa))

class(datos$especiesnativas_normativa)
class(datos1$especiesnativas_normativa)
```

```{r}


model7 <- multinom(especiesnativas_normativa ~ genero, data=datos1)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```

```{r}


model7 <- multinom(especiesnativas_normativa ~ beneficiaria_si_no, data=datos)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```
## Llevar registros

```{r}

names(datos)[62] <- 'registros'
names(datos1)[62] <- 'registros'

datos <- datos %>% mutate( registros = as.factor(registros))
datos1 <- datos1 %>% mutate( registros = as.factor(registros))

class(datos$registros)
class(datos1$registros)
```
```{r}


model7 <- multinom(registros ~ beneficiaria_si_no, data=datos)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```
```{r}


model7 <- multinom(registros ~ genero, data=datos1)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```

```{r}

names(datos)[63] <- 'registros_empirica'
names(datos1)[63] <- 'registros_empirica'

datos <- datos %>% mutate( registros_empirica = as.factor(registros_empirica))
datos1 <- datos1 %>% mutate( registros_empirica = as.factor(registros_empirica))

class(datos$registros_empirica)
class(datos1$registros_empirica)
```

```{r}


model7 <- multinom(registros_empirica ~ beneficiaria_si_no, data=datos)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```
```{r}


model7 <- multinom(registros_empirica ~ genero, data=datos1)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```

```{r}

names(datos)[64] <- 'registros_normativa'
names(datos1)[64] <- 'registros_normativa'

datos <- datos %>% mutate( registros_normativa = as.factor(registros_normativa))
datos1 <- datos1 %>% mutate( registros_normativa = as.factor(registros_normativa))

class(datos$registros_normativa)
class(datos1$registros_normativa)
```
```{r}


model7 <- multinom(registros_normativa ~ genero, data=datos1)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```
```{r}


model7 <- multinom(registros_normativa ~ beneficiaria_si_no, data=datos)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```

## Cambio climático

```{r}

names(datos)[54] <- 'cambioclimatico'
names(datos1)[54] <- 'cambioclimatico'

datos <- datos %>% mutate( cambioclimatico = as.factor(cambioclimatico))
datos1 <- datos1 %>% mutate( cambioclimatico = as.factor(cambioclimatico))

class(datos$cambioclimatico)
class(datos1$cambioclimatico)
```

```{r}


model7 <- multinom(cambioclimatico ~ beneficiaria_si_no, data=datos)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```

```{r}


model7 <- multinom(cambioclimatico ~ genero, data=datos1)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```

```{r}

names(datos)[55] <- 'cambioclimatico_afecta'
names(datos1)[55] <- 'cambioclimatico_afecta'

datos <- datos %>% mutate( cambioclimatico_afecta = as.factor(cambioclimatico_afecta))
datos1 <- datos1 %>% mutate( cambioclimatico_afecta = as.factor(cambioclimatico_afecta))

class(datos$cambioclimatico_afecta)
class(datos1$cambioclimatico_afecta)
```
```{r}


model7 <- multinom(cambioclimatico_afecta ~ genero, data=datos1)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```

```{r}


model7 <- multinom(cambioclimatico_afecta ~ beneficiaria_si_no, data=datos)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```


## más de género

105] "88. En su opiniÃ³n Â¿QuÃ© tanto se involucra a las mujeres de su comunidad en las decisiones de producciÃ³n agropecuaria?"                                                                                       
[106] "89. En su opiniÃ³n Â¿QuÃ© tanto se involucra a las mujeres de su familia en las decisiones de producciÃ³n agropecuaria?"                                                                                         
[107] "90. En su opiniÃ³n Â¿CuÃ¡ntos productores de su comunidad consideran que las mujeres deben participar en las decisiones que se toman con respecto a la producciÃ³n agropecuaria?

```{r}

names(datos)[105] <- 'mujeres_comunidad'
names(datos1)[105] <- 'mujeres_comunidad'

datos <- datos %>% mutate( mujeres_comunidad = as.factor(mujeres_comunidad))
datos1 <- datos1 %>% mutate( mujeres_comunidad = as.factor(mujeres_comunidad))

class(datos$mujeres_comunidad)
class(datos1$mujeres_comunidad)
```

```{r}


model7 <- multinom(mujeres_comunidad ~ genero, data=datos1)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```
```{r}

names(datos)[106] <- 'mujeres_familia'
names(datos1)[106] <- 'mujeres_familia'

datos <- datos %>% mutate( mujeres_familia = as.factor(mujeres_familia))
datos1 <- datos1 %>% mutate( mujeres_familia = as.factor(mujeres_familia))

class(datos$mujeres_familia)
class(datos1$mujeres_familia)
```
```{r}


model7 <- multinom(mujeres_familia  ~ genero, data=datos1)
summary (model7)

odds7 <- exp(coef(model7))
odds7

zvalues7 <- summary(model7)$coefficients / summary(model7)$standard.errors
p.values7 <- pnorm(abs(zvalues7), lower.tail=FALSE)*2
p.values7

```

## segunda base de datos

Importar los datos 

```{r}

datos3 <- rio::import("D:/CAMILO/OTHER ACADEMICS/INFORME RARE 2021/Resultados_para_gianca.xlsx")
```

pie chart frecuencia uso agroquímicos

```{r}
data <- datos3 %>% 
  group_by(`83. ¿Con qué frecuencia aplica los agroquímicos?`) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(`83. ¿Con qué frecuencia aplica los agroquímicos?`))
data$label <- scales::percent(data$per)

ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=`83. ¿Con qué frecuencia aplica los agroquímicos?`), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label=label)) +
  guides(fill=guide_legend(title="¿Con qué frecuencia aplica agroquímicos?"))  + ggtitle("Frecuencia de uso de agroquímicos")
     
```
Promedio de cabezas de ganado
```{r}
datos3$`38.1 Si sí ¿Cuántas cabezas de ganado tiene?` <- recode_factor(datos3$`38.1 Si sí ¿Cuántas cabezas de ganado tiene?`, "No aplica" = "NA")

mean(as.numeric(datos3$`38.1 Si sí ¿Cuántas cabezas de ganado tiene?`), na.rm=TRUE)

summary(as.numeric(datos3$`38.1 Si sí ¿Cuántas cabezas de ganado tiene?`), na.rm=TRUE)

sd(as.numeric(datos3$`38.1 Si sí ¿Cuántas cabezas de ganado tiene?`), na.rm=TRUE)
```

pie chart areas

```{r}
data <- datos3 %>% 
  group_by(`83. ¿Con qué frecuencia aplica los agroquímicos?`) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(`83. ¿Con qué frecuencia aplica los agroquímicos?`))
data$label <- scales::percent(data$per)

ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=`83. ¿Con qué frecuencia aplica los agroquímicos?`), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label=label)) +
  guides(fill=guide_legend(title="¿Con qué frecuencia aplica agroquímicos?"))  + ggtitle("Frecuencia de uso de agroquímicos")
     
```



no asistencia técnica

```{r}

names(datos)[18] <- 'asistencia_tecnica'
names(datos1)[18] <- 'asistencia_tecnica'

datos <- datos %>% mutate( asistencia_tecnica = as.factor(asistencia_tecnica))
datos1 <- datos1 %>% mutate( asistencia_tecnica = as.factor(asistencia_tecnica))

class(datos$asistencia_tecnica)
class(datos1$asistencia_tecnica)
```
```{r}
data <- datos%>% 
  group_by(asistencia_tecnica) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(asistencia_tecnica))
data$label <- scales::percent(data$per)

ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=asistencia_tecnica), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label=label)) 
     
```

```{r}

datos4 <- rio::import("D:/CAMILO/OTHER ACADEMICS/INFORME RARE 2021/rare1.xlsx")
```
```{r}

names(datos4)[18] <- 'asistencia_tecnica'


datos4 <- datos4 %>% mutate( asistencia_tecnica = as.factor(asistencia_tecnica))


class(datos4$asistencia_tecnica)

```
```{r}
datos5 <- filter(datos4, asistencia_tecnica == "Alcaldía" | asistencia_tecnica == "No recibo asistencia técnica" | asistencia_tecnica == "Otra")
```


```{r}
data <- datos5%>% 
  group_by(asistencia_tecnica) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(per=`n`/sum(`n`)) %>% 
  arrange(desc(asistencia_tecnica))
data$label <- scales::percent(data$per)

ggplot(data=data)+
  geom_bar(aes(x="", y=per, fill=asistencia_tecnica), stat="identity", width = 1)+
  coord_polar("y", start=0)+
  theme_void()+
  geom_text(aes(x=1, y = cumsum(per) - per/2, label=label)) +
  guides(fill=guide_legend(title="Tipo de asistencia técnica")) + ggtitle("Tipo de asistencia técnica")
     
```





























asdfasdf